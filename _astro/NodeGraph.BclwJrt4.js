import{j as I}from"./jsx-runtime.Dd8RM4Z7.js";import{r as w,R as C}from"./index.BJb7hJaF.js";import{r as Gs}from"./index.BfnRIxCg.js";/* empty css                       */import{g as Ks}from"./_commonjsHelpers.BosuxZz1.js";import{s as me,k as uo,l as ke,T as Ht,m as Ot}from"./transform.CGKONemN.js";import{n as Cn}from"./router.7tVD49SL.js";import{b as fo}from"./url-builder.DiL2kRuK.js";function re(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,o;n<e.length;n++)(o=re(e[n]))!==""&&(t+=(t&&" ")+o);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}var ho={exports:{}},go={},mo={exports:{}},po={};/**
 * @license React
 * use-sync-external-store-shim.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var et=w;function qs(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Qs=typeof Object.is=="function"?Object.is:qs,Js=et.useState,er=et.useEffect,tr=et.useLayoutEffect,nr=et.useDebugValue;function or(e,t){var n=t(),o=Js({inst:{value:n,getSnapshot:t}}),s=o[0].inst,r=o[1];return tr(function(){s.value=n,s.getSnapshot=t,Vt(s)&&r({inst:s})},[e,n,t]),er(function(){return Vt(s)&&r({inst:s}),e(function(){Vt(s)&&r({inst:s})})},[e]),nr(n),n}function Vt(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Qs(e,n)}catch{return!0}}function sr(e,t){return t()}var rr=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?sr:or;po.useSyncExternalStore=et.useSyncExternalStore!==void 0?et.useSyncExternalStore:rr;mo.exports=po;var ir=mo.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var $t=w,cr=ir;function ar(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var lr=typeof Object.is=="function"?Object.is:ar,ur=cr.useSyncExternalStore,dr=$t.useRef,fr=$t.useEffect,hr=$t.useMemo,gr=$t.useDebugValue;go.useSyncExternalStoreWithSelector=function(e,t,n,o,s){var r=dr(null);if(r.current===null){var i={hasValue:!1,value:null};r.current=i}else i=r.current;r=hr(function(){function a(m){if(!d){if(d=!0,u=m,m=o(m),s!==void 0&&i.hasValue){var S=i.value;if(s(S,m))return f=S}return f=m}if(S=f,lr(u,m))return S;var y=o(m);return s!==void 0&&s(S,y)?S:(u=m,f=y)}var d=!1,u,f,h=n===void 0?null:n;return[function(){return a(t())},h===null?void 0:function(){return a(h())}]},[t,n,o,s]);var c=ur(e,r[0],r[1]);return fr(function(){i.hasValue=!0,i.value=c},[c]),gr(c),c};ho.exports=go;var mr=ho.exports;const pr=Ks(mr),Mn=e=>{let t;const n=new Set,o=(u,f)=>{const h=typeof u=="function"?u(t):u;if(!Object.is(h,t)){const m=t;t=f??(typeof h!="object"||h===null)?h:Object.assign({},t,h),n.forEach(S=>S(t,m))}},s=()=>t,a={setState:o,getState:s,getInitialState:()=>d,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{n.clear()}},d=t=e(o,s,a);return a},yr=e=>e?Mn(e):Mn,{useDebugValue:xr}=C,{useSyncExternalStoreWithSelector:wr}=pr,Er=e=>e;function yo(e,t=Er,n){const o=wr(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return xr(o),o}const $n=(e,t)=>{const n=yr(e),o=(s,r=t)=>yo(n,s,r);return Object.assign(o,n),o},br=(e,t)=>e?$n(e,t):$n;function ce(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}function Sr(e){let t;for(;t=e.sourceEvent;)e=t;return e}function Ee(e,t){if(e=Sr(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var o=n.createSVGPoint();return o.x=e.clientX,o.y=e.clientY,o=o.matrixTransform(t.getScreenCTM().inverse()),[o.x,o.y]}if(t.getBoundingClientRect){var s=t.getBoundingClientRect();return[e.clientX-s.left-t.clientLeft,e.clientY-s.top-t.clientTop]}}return[e.pageX,e.pageY]}const vr={passive:!1},ut={capture:!0,passive:!1};function Lt(e){e.stopImmediatePropagation()}function qe(e){e.preventDefault(),e.stopImmediatePropagation()}function xo(e){var t=e.document.documentElement,n=me(e).on("dragstart.drag",qe,ut);"onselectstart"in t?n.on("selectstart.drag",qe,ut):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function wo(e,t){var n=e.document.documentElement,o=me(e).on("dragstart.drag",null);t&&(o.on("click.drag",qe,ut),setTimeout(function(){o.on("click.drag",null)},0)),"onselectstart"in n?o.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const mt=e=>()=>e;function qt(e,{sourceEvent:t,subject:n,target:o,identifier:s,active:r,x:i,y:c,dx:a,dy:d,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:o,enumerable:!0,configurable:!0},identifier:{value:s,enumerable:!0,configurable:!0},active:{value:r,enumerable:!0,configurable:!0},x:{value:i,enumerable:!0,configurable:!0},y:{value:c,enumerable:!0,configurable:!0},dx:{value:a,enumerable:!0,configurable:!0},dy:{value:d,enumerable:!0,configurable:!0},_:{value:u}})}qt.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Nr(e){return!e.ctrlKey&&!e.button}function Cr(){return this.parentNode}function Mr(e,t){return t??{x:e.x,y:e.y}}function $r(){return navigator.maxTouchPoints||"ontouchstart"in this}function kr(){var e=Nr,t=Cr,n=Mr,o=$r,s={},r=uo("start","drag","end"),i=0,c,a,d,u,f=0;function h(p){p.on("mousedown.drag",m).filter(o).on("touchstart.drag",b).on("touchmove.drag",g,vr).on("touchend.drag touchcancel.drag",v).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function m(p,k){if(!(u||!e.call(this,p,k))){var R=M(this,t.call(this,p,k),p,k,"mouse");R&&(me(p.view).on("mousemove.drag",S,ut).on("mouseup.drag",y,ut),xo(p.view),Lt(p),d=!1,c=p.clientX,a=p.clientY,R("start",p))}}function S(p){if(qe(p),!d){var k=p.clientX-c,R=p.clientY-a;d=k*k+R*R>f}s.mouse("drag",p)}function y(p){me(p.view).on("mousemove.drag mouseup.drag",null),wo(p.view,d),qe(p),s.mouse("end",p)}function b(p,k){if(e.call(this,p,k)){var R=p.changedTouches,O=t.call(this,p,k),P=R.length,z,V;for(z=0;z<P;++z)(V=M(this,O,p,k,R[z].identifier,R[z]))&&(Lt(p),V("start",p,R[z]))}}function g(p){var k=p.changedTouches,R=k.length,O,P;for(O=0;O<R;++O)(P=s[k[O].identifier])&&(qe(p),P("drag",p,k[O]))}function v(p){var k=p.changedTouches,R=k.length,O,P;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),O=0;O<R;++O)(P=s[k[O].identifier])&&(Lt(p),P("end",p,k[O]))}function M(p,k,R,O,P,z){var V=r.copy(),L=Ee(z||R,k),j,H,l;if((l=n.call(p,new qt("beforestart",{sourceEvent:R,target:h,identifier:P,active:i,x:L[0],y:L[1],dx:0,dy:0,dispatch:V}),O))!=null)return j=l.x-L[0]||0,H=l.y-L[1]||0,function N(x,$,_){var E=L,T;switch(x){case"start":s[P]=N,T=i++;break;case"end":delete s[P],--i;case"drag":L=Ee(_||$,k),T=i;break}V.call(x,p,new qt(x,{sourceEvent:$,subject:l,target:h,identifier:P,active:T,x:L[0]+j,y:L[1]+H,dx:L[0]-E[0],dy:L[1]-E[1],dispatch:V}),O)}}return h.filter=function(p){return arguments.length?(e=typeof p=="function"?p:mt(!!p),h):e},h.container=function(p){return arguments.length?(t=typeof p=="function"?p:mt(p),h):t},h.subject=function(p){return arguments.length?(n=typeof p=="function"?p:mt(p),h):n},h.touchable=function(p){return arguments.length?(o=typeof p=="function"?p:mt(!!p),h):o},h.on=function(){var p=r.on.apply(r,arguments);return p===r?h:p},h.clickDistance=function(p){return arguments.length?(f=(p=+p)*p,h):Math.sqrt(f)},h}var Rr=1e-12;function kn(e){return((e=Math.exp(e))+1/e)/2}function Tr(e){return((e=Math.exp(e))-1/e)/2}function zr(e){return((e=Math.exp(2*e))-1)/(e+1)}const Ar=function e(t,n,o){function s(r,i){var c=r[0],a=r[1],d=r[2],u=i[0],f=i[1],h=i[2],m=u-c,S=f-a,y=m*m+S*S,b,g;if(y<Rr)g=Math.log(h/d)/t,b=function(O){return[c+O*m,a+O*S,d*Math.exp(t*O*g)]};else{var v=Math.sqrt(y),M=(h*h-d*d+o*y)/(2*d*n*v),p=(h*h-d*d-o*y)/(2*h*n*v),k=Math.log(Math.sqrt(M*M+1)-M),R=Math.log(Math.sqrt(p*p+1)-p);g=(R-k)/t,b=function(O){var P=O*g,z=kn(k),V=d/(n*v)*(z*zr(t*P+k)-Tr(k));return[c+V*m,a+V*S,d*z/kn(t*P+k)]}}return b.duration=g*1e3*t/Math.SQRT2,b}return s.rho=function(r){var i=Math.max(.001,+r),c=i*i,a=c*c;return e(i,c,a)},s}(Math.SQRT2,2,4),pt=e=>()=>e;function _r(e,{sourceEvent:t,target:n,transform:o,dispatch:s}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:o,enumerable:!0,configurable:!0},_:{value:s}})}function jt(e){e.stopImmediatePropagation()}function rt(e){e.preventDefault(),e.stopImmediatePropagation()}function Ir(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Dr(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Rn(){return this.__zoom||ke}function Pr(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function Hr(){return navigator.maxTouchPoints||"ontouchstart"in this}function Or(e,t,n){var o=e.invertX(t[0][0])-n[0][0],s=e.invertX(t[1][0])-n[1][0],r=e.invertY(t[0][1])-n[0][1],i=e.invertY(t[1][1])-n[1][1];return e.translate(s>o?(o+s)/2:Math.min(0,o)||Math.max(0,s),i>r?(r+i)/2:Math.min(0,r)||Math.max(0,i))}function Vr(){var e=Ir,t=Dr,n=Or,o=Pr,s=Hr,r=[0,1/0],i=[[-1/0,-1/0],[1/0,1/0]],c=250,a=Ar,d=uo("start","zoom","end"),u,f,h,m=500,S=150,y=0,b=10;function g(l){l.property("__zoom",Rn).on("wheel.zoom",P,{passive:!1}).on("mousedown.zoom",z).on("dblclick.zoom",V).filter(s).on("touchstart.zoom",L).on("touchmove.zoom",j).on("touchend.zoom touchcancel.zoom",H).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}g.transform=function(l,N,x,$){var _=l.selection?l.selection():l;_.property("__zoom",Rn),l!==_?k(l,N,x,$):_.interrupt().each(function(){R(this,arguments).event($).start().zoom(null,typeof N=="function"?N.apply(this,arguments):N).end()})},g.scaleBy=function(l,N,x,$){g.scaleTo(l,function(){var _=this.__zoom.k,E=typeof N=="function"?N.apply(this,arguments):N;return _*E},x,$)},g.scaleTo=function(l,N,x,$){g.transform(l,function(){var _=t.apply(this,arguments),E=this.__zoom,T=x==null?p(_):typeof x=="function"?x.apply(this,arguments):x,A=E.invert(T),D=typeof N=="function"?N.apply(this,arguments):N;return n(M(v(E,D),T,A),_,i)},x,$)},g.translateBy=function(l,N,x,$){g.transform(l,function(){return n(this.__zoom.translate(typeof N=="function"?N.apply(this,arguments):N,typeof x=="function"?x.apply(this,arguments):x),t.apply(this,arguments),i)},null,$)},g.translateTo=function(l,N,x,$,_){g.transform(l,function(){var E=t.apply(this,arguments),T=this.__zoom,A=$==null?p(E):typeof $=="function"?$.apply(this,arguments):$;return n(ke.translate(A[0],A[1]).scale(T.k).translate(typeof N=="function"?-N.apply(this,arguments):-N,typeof x=="function"?-x.apply(this,arguments):-x),E,i)},$,_)};function v(l,N){return N=Math.max(r[0],Math.min(r[1],N)),N===l.k?l:new Ht(N,l.x,l.y)}function M(l,N,x){var $=N[0]-x[0]*l.k,_=N[1]-x[1]*l.k;return $===l.x&&_===l.y?l:new Ht(l.k,$,_)}function p(l){return[(+l[0][0]+ +l[1][0])/2,(+l[0][1]+ +l[1][1])/2]}function k(l,N,x,$){l.on("start.zoom",function(){R(this,arguments).event($).start()}).on("interrupt.zoom end.zoom",function(){R(this,arguments).event($).end()}).tween("zoom",function(){var _=this,E=arguments,T=R(_,E).event($),A=t.apply(_,E),D=x==null?p(A):typeof x=="function"?x.apply(_,E):x,B=Math.max(A[1][0]-A[0][0],A[1][1]-A[0][1]),F=_.__zoom,W=typeof N=="function"?N.apply(_,E):N,X=a(F.invert(D).concat(B/F.k),W.invert(D).concat(B/W.k));return function(G){if(G===1)G=W;else{var K=X(G),ee=B/K[2];G=new Ht(ee,D[0]-K[0]*ee,D[1]-K[1]*ee)}T.zoom(null,G)}})}function R(l,N,x){return!x&&l.__zooming||new O(l,N)}function O(l,N){this.that=l,this.args=N,this.active=0,this.sourceEvent=null,this.extent=t.apply(l,N),this.taps=0}O.prototype={event:function(l){return l&&(this.sourceEvent=l),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(l,N){return this.mouse&&l!=="mouse"&&(this.mouse[1]=N.invert(this.mouse[0])),this.touch0&&l!=="touch"&&(this.touch0[1]=N.invert(this.touch0[0])),this.touch1&&l!=="touch"&&(this.touch1[1]=N.invert(this.touch1[0])),this.that.__zoom=N,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(l){var N=me(this.that).datum();d.call(l,this.that,new _r(l,{sourceEvent:this.sourceEvent,target:g,type:l,transform:this.that.__zoom,dispatch:d}),N)}};function P(l,...N){if(!e.apply(this,arguments))return;var x=R(this,N).event(l),$=this.__zoom,_=Math.max(r[0],Math.min(r[1],$.k*Math.pow(2,o.apply(this,arguments)))),E=Ee(l);if(x.wheel)(x.mouse[0][0]!==E[0]||x.mouse[0][1]!==E[1])&&(x.mouse[1]=$.invert(x.mouse[0]=E)),clearTimeout(x.wheel);else{if($.k===_)return;x.mouse=[E,$.invert(E)],Ot(this),x.start()}rt(l),x.wheel=setTimeout(T,S),x.zoom("mouse",n(M(v($,_),x.mouse[0],x.mouse[1]),x.extent,i));function T(){x.wheel=null,x.end()}}function z(l,...N){if(h||!e.apply(this,arguments))return;var x=l.currentTarget,$=R(this,N,!0).event(l),_=me(l.view).on("mousemove.zoom",D,!0).on("mouseup.zoom",B,!0),E=Ee(l,x),T=l.clientX,A=l.clientY;xo(l.view),jt(l),$.mouse=[E,this.__zoom.invert(E)],Ot(this),$.start();function D(F){if(rt(F),!$.moved){var W=F.clientX-T,X=F.clientY-A;$.moved=W*W+X*X>y}$.event(F).zoom("mouse",n(M($.that.__zoom,$.mouse[0]=Ee(F,x),$.mouse[1]),$.extent,i))}function B(F){_.on("mousemove.zoom mouseup.zoom",null),wo(F.view,$.moved),rt(F),$.event(F).end()}}function V(l,...N){if(e.apply(this,arguments)){var x=this.__zoom,$=Ee(l.changedTouches?l.changedTouches[0]:l,this),_=x.invert($),E=x.k*(l.shiftKey?.5:2),T=n(M(v(x,E),$,_),t.apply(this,N),i);rt(l),c>0?me(this).transition().duration(c).call(k,T,$,l):me(this).call(g.transform,T,$,l)}}function L(l,...N){if(e.apply(this,arguments)){var x=l.touches,$=x.length,_=R(this,N,l.changedTouches.length===$).event(l),E,T,A,D;for(jt(l),T=0;T<$;++T)A=x[T],D=Ee(A,this),D=[D,this.__zoom.invert(D),A.identifier],_.touch0?!_.touch1&&_.touch0[2]!==D[2]&&(_.touch1=D,_.taps=0):(_.touch0=D,E=!0,_.taps=1+!!u);u&&(u=clearTimeout(u)),E&&(_.taps<2&&(f=D[0],u=setTimeout(function(){u=null},m)),Ot(this),_.start())}}function j(l,...N){if(this.__zooming){var x=R(this,N).event(l),$=l.changedTouches,_=$.length,E,T,A,D;for(rt(l),E=0;E<_;++E)T=$[E],A=Ee(T,this),x.touch0&&x.touch0[2]===T.identifier?x.touch0[0]=A:x.touch1&&x.touch1[2]===T.identifier&&(x.touch1[0]=A);if(T=x.that.__zoom,x.touch1){var B=x.touch0[0],F=x.touch0[1],W=x.touch1[0],X=x.touch1[1],G=(G=W[0]-B[0])*G+(G=W[1]-B[1])*G,K=(K=X[0]-F[0])*K+(K=X[1]-F[1])*K;T=v(T,Math.sqrt(G/K)),A=[(B[0]+W[0])/2,(B[1]+W[1])/2],D=[(F[0]+X[0])/2,(F[1]+X[1])/2]}else if(x.touch0)A=x.touch0[0],D=x.touch0[1];else return;x.zoom("touch",n(M(T,A,D),x.extent,i))}}function H(l,...N){if(this.__zooming){var x=R(this,N).event(l),$=l.changedTouches,_=$.length,E,T;for(jt(l),h&&clearTimeout(h),h=setTimeout(function(){h=null},m),E=0;E<_;++E)T=$[E],x.touch0&&x.touch0[2]===T.identifier?delete x.touch0:x.touch1&&x.touch1[2]===T.identifier&&delete x.touch1;if(x.touch1&&!x.touch0&&(x.touch0=x.touch1,delete x.touch1),x.touch0)x.touch0[1]=this.__zoom.invert(x.touch0[0]);else if(x.end(),x.taps===2&&(T=Ee(T,this),Math.hypot(f[0]-T[0],f[1]-T[1])<b)){var A=me(this).on("dblclick.zoom");A&&A.apply(this,arguments)}}}return g.wheelDelta=function(l){return arguments.length?(o=typeof l=="function"?l:pt(+l),g):o},g.filter=function(l){return arguments.length?(e=typeof l=="function"?l:pt(!!l),g):e},g.touchable=function(l){return arguments.length?(s=typeof l=="function"?l:pt(!!l),g):s},g.extent=function(l){return arguments.length?(t=typeof l=="function"?l:pt([[+l[0][0],+l[0][1]],[+l[1][0],+l[1][1]]]),g):t},g.scaleExtent=function(l){return arguments.length?(r[0]=+l[0],r[1]=+l[1],g):[r[0],r[1]]},g.translateExtent=function(l){return arguments.length?(i[0][0]=+l[0][0],i[1][0]=+l[1][0],i[0][1]=+l[0][1],i[1][1]=+l[1][1],g):[[i[0][0],i[0][1]],[i[1][0],i[1][1]]]},g.constrain=function(l){return arguments.length?(n=l,g):n},g.duration=function(l){return arguments.length?(c=+l,g):c},g.interpolate=function(l){return arguments.length?(a=l,g):a},g.on=function(){var l=d.on.apply(d,arguments);return l===d?g:l},g.clickDistance=function(l){return arguments.length?(y=(l=+l)*l,g):Math.sqrt(y)},g.tapDistance=function(l){return arguments.length?(b=+l,g):b},g}const kt=w.createContext(null),Lr=kt.Provider,Ce={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,t)=>`Couldn't create edge for ${e?"target":"source"} handle id: "${e?t.targetHandle:t.sourceHandle}", edge id: ${t.id}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`},Eo=Ce.error001();function J(e,t){const n=w.useContext(kt);if(n===null)throw new Error(Eo);return yo(n,e,t)}const oe=()=>{const e=w.useContext(kt);if(e===null)throw new Error(Eo);return w.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe,destroy:e.destroy}),[e])},jr=e=>e.userSelectionActive?"none":"all";function dt({position:e,children:t,className:n,style:o,...s}){const r=J(jr),i=`${e}`.split("-");return C.createElement("div",{className:re(["react-flow__panel",n,...i]),style:{...o,pointerEvents:r},...s},t)}function Fr({proOptions:e,position:t="bottom-right"}){return e?.hideAttribution?null:C.createElement(dt,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://reactflow.dev/pro"},C.createElement("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution"},"React Flow"))}const Br=({x:e,y:t,label:n,labelStyle:o={},labelShowBg:s=!0,labelBgStyle:r={},labelBgPadding:i=[2,4],labelBgBorderRadius:c=2,children:a,className:d,...u})=>{const f=w.useRef(null),[h,m]=w.useState({x:0,y:0,width:0,height:0}),S=re(["react-flow__edge-textwrapper",d]);return w.useEffect(()=>{if(f.current){const y=f.current.getBBox();m({x:y.x,y:y.y,width:y.width,height:y.height})}},[n]),typeof n>"u"||!n?null:C.createElement("g",{transform:`translate(${e-h.width/2} ${t-h.height/2})`,className:S,visibility:h.width?"visible":"hidden",...u},s&&C.createElement("rect",{width:h.width+2*i[0],x:-i[0],y:-i[1],height:h.height+2*i[1],className:"react-flow__edge-textbg",style:r,rx:c,ry:c}),C.createElement("text",{className:"react-flow__edge-text",y:h.height/2,dy:"0.3em",ref:f,style:o},n),a)};var Ur=w.memo(Br);const an=e=>({width:e.offsetWidth,height:e.offsetHeight}),tt=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),ln=(e={x:0,y:0},t)=>({x:tt(e.x,t[0][0],t[1][0]),y:tt(e.y,t[0][1],t[1][1])}),Tn=(e,t,n)=>e<t?tt(Math.abs(e-t),1,50)/50:e>n?-tt(Math.abs(e-n),1,50)/50:0,bo=(e,t)=>{const n=Tn(e.x,35,t.width-35)*20,o=Tn(e.y,35,t.height-35)*20;return[n,o]},So=e=>e.getRootNode?.()||window?.document,Zr=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),un=({x:e,y:t,width:n,height:o})=>({x:e,y:t,x2:e+n,y2:t+o}),Wr=({x:e,y:t,x2:n,y2:o})=>({x:e,y:t,width:n-e,height:o-t}),zn=e=>({...e.positionAbsolute||{x:0,y:0},width:e.width||0,height:e.height||0}),Qt=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),o=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*o)},Yr=e=>fe(e.width)&&fe(e.height)&&fe(e.x)&&fe(e.y),fe=e=>!isNaN(e)&&isFinite(e),te=Symbol.for("internals"),vo=["Enter"," ","Escape"],Xr=(e,t)=>{},Gr=e=>"nativeEvent"in e;function Jt(e){const n=(Gr(e)?e.nativeEvent:e).composedPath?.()?.[0]||e.target;return["INPUT","SELECT","TEXTAREA"].includes(n?.nodeName)||n?.hasAttribute("contenteditable")||!!n?.closest(".nokey")}const No=e=>"clientX"in e,Re=(e,t)=>{const n=No(e),o=n?e.clientX:e.touches?.[0].clientX,s=n?e.clientY:e.touches?.[0].clientY;return{x:o-(t?.left??0),y:s-(t?.top??0)}},St=()=>typeof navigator<"u"&&navigator?.userAgent?.indexOf("Mac")>=0,gt=({id:e,path:t,labelX:n,labelY:o,label:s,labelStyle:r,labelShowBg:i,labelBgStyle:c,labelBgPadding:a,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:h,interactionWidth:m=20})=>C.createElement(C.Fragment,null,C.createElement("path",{id:e,style:u,d:t,fill:"none",className:"react-flow__edge-path",markerEnd:f,markerStart:h}),m&&C.createElement("path",{d:t,fill:"none",strokeOpacity:0,strokeWidth:m,className:"react-flow__edge-interaction"}),s&&fe(n)&&fe(o)?C.createElement(Ur,{x:n,y:o,label:s,labelStyle:r,labelShowBg:i,labelBgStyle:c,labelBgPadding:a,labelBgBorderRadius:d}):null);gt.displayName="BaseEdge";function it(e,t,n){return n===void 0?n:o=>{const s=t().edges.find(r=>r.id===e);s&&n(o,{...s})}}function Co({sourceX:e,sourceY:t,targetX:n,targetY:o}){const s=Math.abs(n-e)/2,r=n<e?n+s:n-s,i=Math.abs(o-t)/2,c=o<t?o+i:o-i;return[r,c,s,i]}function Mo({sourceX:e,sourceY:t,targetX:n,targetY:o,sourceControlX:s,sourceControlY:r,targetControlX:i,targetControlY:c}){const a=e*.125+s*.375+i*.375+n*.125,d=t*.125+r*.375+c*.375+o*.125,u=Math.abs(a-e),f=Math.abs(d-t);return[a,d,u,f]}var Ve;(function(e){e.Strict="strict",e.Loose="loose"})(Ve||(Ve={}));var Oe;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(Oe||(Oe={}));var ft;(function(e){e.Partial="partial",e.Full="full"})(ft||(ft={}));var ve;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(ve||(ve={}));var vt;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(vt||(vt={}));var U;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(U||(U={}));function An({pos:e,x1:t,y1:n,x2:o,y2:s}){return e===U.Left||e===U.Right?[.5*(t+o),n]:[t,.5*(n+s)]}function $o({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:o,targetY:s,targetPosition:r=U.Top}){const[i,c]=An({pos:n,x1:e,y1:t,x2:o,y2:s}),[a,d]=An({pos:r,x1:o,y1:s,x2:e,y2:t}),[u,f,h,m]=Mo({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:i,sourceControlY:c,targetControlX:a,targetControlY:d});return[`M${e},${t} C${i},${c} ${a},${d} ${o},${s}`,u,f,h,m]}const dn=w.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=U.Bottom,targetPosition:r=U.Top,label:i,labelStyle:c,labelShowBg:a,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:h,markerEnd:m,markerStart:S,interactionWidth:y})=>{const[b,g,v]=$o({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:r});return C.createElement(gt,{path:b,labelX:g,labelY:v,label:i,labelStyle:c,labelShowBg:a,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:h,markerEnd:m,markerStart:S,interactionWidth:y})});dn.displayName="SimpleBezierEdge";const _n={[U.Left]:{x:-1,y:0},[U.Right]:{x:1,y:0},[U.Top]:{x:0,y:-1},[U.Bottom]:{x:0,y:1}},Kr=({source:e,sourcePosition:t=U.Bottom,target:n})=>t===U.Left||t===U.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},In=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function qr({source:e,sourcePosition:t=U.Bottom,target:n,targetPosition:o=U.Top,center:s,offset:r}){const i=_n[t],c=_n[o],a={x:e.x+i.x*r,y:e.y+i.y*r},d={x:n.x+c.x*r,y:n.y+c.y*r},u=Kr({source:a,sourcePosition:t,target:d}),f=u.x!==0?"x":"y",h=u[f];let m=[],S,y;const b={x:0,y:0},g={x:0,y:0},[v,M,p,k]=Co({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(i[f]*c[f]===-1){S=s.x??v,y=s.y??M;const O=[{x:S,y:a.y},{x:S,y:d.y}],P=[{x:a.x,y},{x:d.x,y}];i[f]===h?m=f==="x"?O:P:m=f==="x"?P:O}else{const O=[{x:a.x,y:d.y}],P=[{x:d.x,y:a.y}];if(f==="x"?m=i.x===h?P:O:m=i.y===h?O:P,t===o){const H=Math.abs(e[f]-n[f]);if(H<=r){const l=Math.min(r-1,r-H);i[f]===h?b[f]=(a[f]>e[f]?-1:1)*l:g[f]=(d[f]>n[f]?-1:1)*l}}if(t!==o){const H=f==="x"?"y":"x",l=i[f]===c[H],N=a[H]>d[H],x=a[H]<d[H];(i[f]===1&&(!l&&N||l&&x)||i[f]!==1&&(!l&&x||l&&N))&&(m=f==="x"?O:P)}const z={x:a.x+b.x,y:a.y+b.y},V={x:d.x+g.x,y:d.y+g.y},L=Math.max(Math.abs(z.x-m[0].x),Math.abs(V.x-m[0].x)),j=Math.max(Math.abs(z.y-m[0].y),Math.abs(V.y-m[0].y));L>=j?(S=(z.x+V.x)/2,y=m[0].y):(S=m[0].x,y=(z.y+V.y)/2)}return[[e,{x:a.x+b.x,y:a.y+b.y},...m,{x:d.x+g.x,y:d.y+g.y},n],S,y,p,k]}function Qr(e,t,n,o){const s=Math.min(In(e,t)/2,In(t,n)/2,o),{x:r,y:i}=t;if(e.x===r&&r===n.x||e.y===i&&i===n.y)return`L${r} ${i}`;if(e.y===i){const d=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${r+s*d},${i}Q ${r},${i} ${r},${i+s*u}`}const c=e.x<n.x?1:-1,a=e.y<n.y?-1:1;return`L ${r},${i+s*a}Q ${r},${i} ${r+s*c},${i}`}function en({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:o,targetY:s,targetPosition:r=U.Top,borderRadius:i=5,centerX:c,centerY:a,offset:d=20}){const[u,f,h,m,S]=qr({source:{x:e,y:t},sourcePosition:n,target:{x:o,y:s},targetPosition:r,center:{x:c,y:a},offset:d});return[u.reduce((b,g,v)=>{let M="";return v>0&&v<u.length-1?M=Qr(u[v-1],g,u[v+1],i):M=`${v===0?"M":"L"}${g.x} ${g.y}`,b+=M,b},""),f,h,m,S]}const Rt=w.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:r,labelShowBg:i,labelBgStyle:c,labelBgPadding:a,labelBgBorderRadius:d,style:u,sourcePosition:f=U.Bottom,targetPosition:h=U.Top,markerEnd:m,markerStart:S,pathOptions:y,interactionWidth:b})=>{const[g,v,M]=en({sourceX:e,sourceY:t,sourcePosition:f,targetX:n,targetY:o,targetPosition:h,borderRadius:y?.borderRadius,offset:y?.offset});return C.createElement(gt,{path:g,labelX:v,labelY:M,label:s,labelStyle:r,labelShowBg:i,labelBgStyle:c,labelBgPadding:a,labelBgBorderRadius:d,style:u,markerEnd:m,markerStart:S,interactionWidth:b})});Rt.displayName="SmoothStepEdge";const fn=w.memo(e=>C.createElement(Rt,{...e,pathOptions:w.useMemo(()=>({borderRadius:0,offset:e.pathOptions?.offset}),[e.pathOptions?.offset])}));fn.displayName="StepEdge";function Jr({sourceX:e,sourceY:t,targetX:n,targetY:o}){const[s,r,i,c]=Co({sourceX:e,sourceY:t,targetX:n,targetY:o});return[`M ${e},${t}L ${n},${o}`,s,r,i,c]}const hn=w.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,label:s,labelStyle:r,labelShowBg:i,labelBgStyle:c,labelBgPadding:a,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:h,interactionWidth:m})=>{const[S,y,b]=Jr({sourceX:e,sourceY:t,targetX:n,targetY:o});return C.createElement(gt,{path:S,labelX:y,labelY:b,label:s,labelStyle:r,labelShowBg:i,labelBgStyle:c,labelBgPadding:a,labelBgBorderRadius:d,style:u,markerEnd:f,markerStart:h,interactionWidth:m})});hn.displayName="StraightEdge";function yt(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Dn({pos:e,x1:t,y1:n,x2:o,y2:s,c:r}){switch(e){case U.Left:return[t-yt(t-o,r),n];case U.Right:return[t+yt(o-t,r),n];case U.Top:return[t,n-yt(n-s,r)];case U.Bottom:return[t,n+yt(s-n,r)]}}function ko({sourceX:e,sourceY:t,sourcePosition:n=U.Bottom,targetX:o,targetY:s,targetPosition:r=U.Top,curvature:i=.25}){const[c,a]=Dn({pos:n,x1:e,y1:t,x2:o,y2:s,c:i}),[d,u]=Dn({pos:r,x1:o,y1:s,x2:e,y2:t,c:i}),[f,h,m,S]=Mo({sourceX:e,sourceY:t,targetX:o,targetY:s,sourceControlX:c,sourceControlY:a,targetControlX:d,targetControlY:u});return[`M${e},${t} C${c},${a} ${d},${u} ${o},${s}`,f,h,m,S]}const Nt=w.memo(({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:s=U.Bottom,targetPosition:r=U.Top,label:i,labelStyle:c,labelShowBg:a,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:h,markerEnd:m,markerStart:S,pathOptions:y,interactionWidth:b})=>{const[g,v,M]=ko({sourceX:e,sourceY:t,sourcePosition:s,targetX:n,targetY:o,targetPosition:r,curvature:y?.curvature});return C.createElement(gt,{path:g,labelX:v,labelY:M,label:i,labelStyle:c,labelShowBg:a,labelBgStyle:d,labelBgPadding:u,labelBgBorderRadius:f,style:h,markerEnd:m,markerStart:S,interactionWidth:b})});Nt.displayName="BezierEdge";const gn=w.createContext(null),ei=gn.Provider;gn.Consumer;const ti=()=>w.useContext(gn),ni=e=>"id"in e&&"source"in e&&"target"in e,oi=({source:e,sourceHandle:t,target:n,targetHandle:o})=>`reactflow__edge-${e}${t||""}-${n}${o||""}`,tn=(e,t)=>typeof e>"u"?"":typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(o=>`${o}=${e[o]}`).join("&")}`,si=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),ri=(e,t)=>{if(!e.source||!e.target)return t;let n;return ni(e)?n={...e}:n={...e,id:oi(e)},si(n,t)?t:t.concat(n)},nn=({x:e,y:t},[n,o,s],r,[i,c])=>{const a={x:(e-n)/s,y:(t-o)/s};return r?{x:i*Math.round(a.x/i),y:c*Math.round(a.y/c)}:a},Ro=({x:e,y:t},[n,o,s])=>({x:e*s+n,y:t*s+o}),Qe=(e,t=[0,0])=>{if(!e)return{x:0,y:0,positionAbsolute:{x:0,y:0}};const n=(e.width??0)*t[0],o=(e.height??0)*t[1],s={x:e.position.x-n,y:e.position.y-o};return{...s,positionAbsolute:e.positionAbsolute?{x:e.positionAbsolute.x-n,y:e.positionAbsolute.y-o}:s}},Tt=(e,t=[0,0])=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((o,s)=>{const{x:r,y:i}=Qe(s,t).positionAbsolute;return Zr(o,un({x:r,y:i,width:s.width||0,height:s.height||0}))},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Wr(n)},ii=(e,t=[0,0])=>(console.warn("[DEPRECATED] `getRectOfNodes` is deprecated. Instead use `getNodesBounds` https://reactflow.dev/api-reference/utils/get-nodes-bounds."),Tt(e,t)),To=(e,t,[n,o,s]=[0,0,1],r=!1,i=!1,c=[0,0])=>{const a={x:(t.x-n)/s,y:(t.y-o)/s,width:t.width/s,height:t.height/s},d=[];return e.forEach(u=>{const{width:f,height:h,selectable:m=!0,hidden:S=!1}=u;if(i&&!m||S)return!1;const{positionAbsolute:y}=Qe(u,c),b={x:y.x,y:y.y,width:f||0,height:h||0},g=Qt(a,b),v=typeof f>"u"||typeof h>"u"||f===null||h===null,M=r&&g>0,p=(f||0)*(h||0);(v||M||g>=p||u.dragging)&&d.push(u)}),d},zo=(e,t)=>{const n=e.map(o=>o.id);return t.filter(o=>n.includes(o.source)||n.includes(o.target))},Ao=(e,t,n,o,s,r=.1)=>{const i=t/(e.width*(1+r)),c=n/(e.height*(1+r)),a=Math.min(i,c),d=tt(a,o,s),u=e.x+e.width/2,f=e.y+e.height/2,h=t/2-u*d,m=n/2-f*d;return{x:h,y:m,zoom:d}},He=(e,t=0)=>e.transition().duration(t);function Pn(e,t,n,o){return(t[n]||[]).reduce((s,r)=>(`${e.id}-${r.id}-${n}`!==o&&s.push({id:r.id||null,type:n,nodeId:e.id,x:(e.positionAbsolute?.x??0)+r.x+r.width/2,y:(e.positionAbsolute?.y??0)+r.y+r.height/2}),s),[])}function ci(e,t,n,o,s,r){const{x:i,y:c}=Re(e),d=t.elementsFromPoint(i,c).find(S=>S.classList.contains("react-flow__handle"));if(d){const S=d.getAttribute("data-nodeid");if(S){const y=mn(void 0,d),b=d.getAttribute("data-handleid"),g=r({nodeId:S,id:b,type:y});if(g){const v=s.find(M=>M.nodeId===S&&M.type===y&&M.id===b);return{handle:{id:b,type:y,nodeId:S,x:v?.x||n.x,y:v?.y||n.y},validHandleResult:g}}}}let u=[],f=1/0;if(s.forEach(S=>{const y=Math.sqrt((S.x-n.x)**2+(S.y-n.y)**2);if(y<=o){const b=r(S);y<=f&&(y<f?u=[{handle:S,validHandleResult:b}]:y===f&&u.push({handle:S,validHandleResult:b}),f=y)}}),!u.length)return{handle:null,validHandleResult:_o()};if(u.length===1)return u[0];const h=u.some(({validHandleResult:S})=>S.isValid),m=u.some(({handle:S})=>S.type==="target");return u.find(({handle:S,validHandleResult:y})=>m?S.type==="target":h?y.isValid:!0)||u[0]}const ai={source:null,target:null,sourceHandle:null,targetHandle:null},_o=()=>({handleDomNode:null,isValid:!1,connection:ai,endHandle:null});function Io(e,t,n,o,s,r,i){const c=s==="target",a=i.querySelector(`.react-flow__handle[data-id="${e?.nodeId}-${e?.id}-${e?.type}"]`),d={..._o(),handleDomNode:a};if(a){const u=mn(void 0,a),f=a.getAttribute("data-nodeid"),h=a.getAttribute("data-handleid"),m=a.classList.contains("connectable"),S=a.classList.contains("connectableend"),y={source:c?f:n,sourceHandle:c?h:o,target:c?n:f,targetHandle:c?o:h};d.connection=y,m&&S&&(t===Ve.Strict?c&&u==="source"||!c&&u==="target":f!==n||h!==o)&&(d.endHandle={nodeId:f,handleId:h,type:u},d.isValid=r(y))}return d}function li({nodes:e,nodeId:t,handleId:n,handleType:o}){return e.reduce((s,r)=>{if(r[te]){const{handleBounds:i}=r[te];let c=[],a=[];i&&(c=Pn(r,i,"source",`${t}-${n}-${o}`),a=Pn(r,i,"target",`${t}-${n}-${o}`)),s.push(...c,...a)}return s},[])}function mn(e,t){return e||(t?.classList.contains("target")?"target":t?.classList.contains("source")?"source":null)}function Ft(e){e?.classList.remove("valid","connecting","react-flow__handle-valid","react-flow__handle-connecting")}function ui(e,t){let n=null;return t?n="valid":e&&!t&&(n="invalid"),n}function Do({event:e,handleId:t,nodeId:n,onConnect:o,isTarget:s,getState:r,setState:i,isValidConnection:c,edgeUpdaterType:a,onReconnectEnd:d}){const u=So(e.target),{connectionMode:f,domNode:h,autoPanOnConnect:m,connectionRadius:S,onConnectStart:y,panBy:b,getNodes:g,cancelConnection:v}=r();let M=0,p;const{x:k,y:R}=Re(e),O=u?.elementFromPoint(k,R),P=mn(a,O),z=h?.getBoundingClientRect();if(!z||!P)return;let V,L=Re(e,z),j=!1,H=null,l=!1,N=null;const x=li({nodes:g(),nodeId:n,handleId:t,handleType:P}),$=()=>{if(!m)return;const[T,A]=bo(L,z);b({x:T,y:A}),M=requestAnimationFrame($)};i({connectionPosition:L,connectionStatus:null,connectionNodeId:n,connectionHandleId:t,connectionHandleType:P,connectionStartHandle:{nodeId:n,handleId:t,type:P},connectionEndHandle:null}),y?.(e,{nodeId:n,handleId:t,handleType:P});function _(T){const{transform:A}=r();L=Re(T,z);const{handle:D,validHandleResult:B}=ci(T,u,nn(L,A,!1,[1,1]),S,x,F=>Io(F,f,n,t,s?"target":"source",c,u));if(p=D,j||($(),j=!0),N=B.handleDomNode,H=B.connection,l=B.isValid,i({connectionPosition:p&&l?Ro({x:p.x,y:p.y},A):L,connectionStatus:ui(!!p,l),connectionEndHandle:B.endHandle}),!p&&!l&&!N)return Ft(V);H.source!==H.target&&N&&(Ft(V),V=N,N.classList.add("connecting","react-flow__handle-connecting"),N.classList.toggle("valid",l),N.classList.toggle("react-flow__handle-valid",l))}function E(T){(p||N)&&H&&l&&o?.(H),r().onConnectEnd?.(T),a&&d?.(T),Ft(V),v(),cancelAnimationFrame(M),j=!1,l=!1,H=null,N=null,u.removeEventListener("mousemove",_),u.removeEventListener("mouseup",E),u.removeEventListener("touchmove",_),u.removeEventListener("touchend",E)}u.addEventListener("mousemove",_),u.addEventListener("mouseup",E),u.addEventListener("touchmove",_),u.addEventListener("touchend",E)}const Hn=()=>!0,di=e=>({connectionStartHandle:e.connectionStartHandle,connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName}),fi=(e,t,n)=>o=>{const{connectionStartHandle:s,connectionEndHandle:r,connectionClickStartHandle:i}=o;return{connecting:s?.nodeId===e&&s?.handleId===t&&s?.type===n||r?.nodeId===e&&r?.handleId===t&&r?.type===n,clickConnecting:i?.nodeId===e&&i?.handleId===t&&i?.type===n}},Po=w.forwardRef(({type:e="source",position:t=U.Top,isValidConnection:n,isConnectable:o=!0,isConnectableStart:s=!0,isConnectableEnd:r=!0,id:i,onConnect:c,children:a,className:d,onMouseDown:u,onTouchStart:f,...h},m)=>{const S=i||null,y=e==="target",b=oe(),g=ti(),{connectOnClick:v,noPanClassName:M}=J(di,ce),{connecting:p,clickConnecting:k}=J(fi(g,S,e),ce);g||b.getState().onError?.("010",Ce.error010());const R=z=>{const{defaultEdgeOptions:V,onConnect:L,hasDefaultEdges:j}=b.getState(),H={...V,...z};if(j){const{edges:l,setEdges:N}=b.getState();N(ri(H,l))}L?.(H),c?.(H)},O=z=>{if(!g)return;const V=No(z);s&&(V&&z.button===0||!V)&&Do({event:z,handleId:S,nodeId:g,onConnect:R,isTarget:y,getState:b.getState,setState:b.setState,isValidConnection:n||b.getState().isValidConnection||Hn}),V?u?.(z):f?.(z)},P=z=>{const{onClickConnectStart:V,onClickConnectEnd:L,connectionClickStartHandle:j,connectionMode:H,isValidConnection:l}=b.getState();if(!g||!j&&!s)return;if(!j){V?.(z,{nodeId:g,handleId:S,handleType:e}),b.setState({connectionClickStartHandle:{nodeId:g,type:e,handleId:S}});return}const N=So(z.target),x=n||l||Hn,{connection:$,isValid:_}=Io({nodeId:g,id:S,type:e},H,j.nodeId,j.handleId||null,j.type,x,N);_&&R($),L?.(z),b.setState({connectionClickStartHandle:null})};return C.createElement("div",{"data-handleid":S,"data-nodeid":g,"data-handlepos":t,"data-id":`${g}-${S}-${e}`,className:re(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",M,d,{source:!y,target:y,connectable:o,connectablestart:s,connectableend:r,connecting:k,connectionindicator:o&&(s&&!p||r&&p)}]),onMouseDown:O,onTouchStart:O,onClick:v?P:void 0,ref:m,...h},a)});Po.displayName="Handle";var be=w.memo(Po);const Ho=({data:e,isConnectable:t,targetPosition:n=U.Top,sourcePosition:o=U.Bottom})=>C.createElement(C.Fragment,null,C.createElement(be,{type:"target",position:n,isConnectable:t}),e?.label,C.createElement(be,{type:"source",position:o,isConnectable:t}));Ho.displayName="DefaultNode";var on=w.memo(Ho);const Oo=({data:e,isConnectable:t,sourcePosition:n=U.Bottom})=>C.createElement(C.Fragment,null,e?.label,C.createElement(be,{type:"source",position:n,isConnectable:t}));Oo.displayName="InputNode";var Vo=w.memo(Oo);const Lo=({data:e,isConnectable:t,targetPosition:n=U.Top})=>C.createElement(C.Fragment,null,C.createElement(be,{type:"target",position:n,isConnectable:t}),e?.label);Lo.displayName="OutputNode";var jo=w.memo(Lo);const pn=()=>null;pn.displayName="GroupNode";const hi=e=>({selectedNodes:e.getNodes().filter(t=>t.selected),selectedEdges:e.edges.filter(t=>t.selected).map(t=>({...t}))}),xt=e=>e.id;function gi(e,t){return ce(e.selectedNodes.map(xt),t.selectedNodes.map(xt))&&ce(e.selectedEdges.map(xt),t.selectedEdges.map(xt))}const Fo=w.memo(({onSelectionChange:e})=>{const t=oe(),{selectedNodes:n,selectedEdges:o}=J(hi,gi);return w.useEffect(()=>{const s={nodes:n,edges:o};e?.(s),t.getState().onSelectionChange.forEach(r=>r(s))},[n,o,e]),null});Fo.displayName="SelectionListener";const mi=e=>!!e.onSelectionChange;function pi({onSelectionChange:e}){const t=J(mi);return e||t?C.createElement(Fo,{onSelectionChange:e}):null}const yi=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset});function We(e,t){w.useEffect(()=>{typeof e<"u"&&t(e)},[e])}function Y(e,t,n){w.useEffect(()=>{typeof t<"u"&&n({[e]:t})},[t])}const xi=({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:s,onConnectStart:r,onConnectEnd:i,onClickConnectStart:c,onClickConnectEnd:a,nodesDraggable:d,nodesConnectable:u,nodesFocusable:f,edgesFocusable:h,edgesUpdatable:m,elevateNodesOnSelect:S,minZoom:y,maxZoom:b,nodeExtent:g,onNodesChange:v,onEdgesChange:M,elementsSelectable:p,connectionMode:k,snapGrid:R,snapToGrid:O,translateExtent:P,connectOnClick:z,defaultEdgeOptions:V,fitView:L,fitViewOptions:j,onNodesDelete:H,onEdgesDelete:l,onNodeDrag:N,onNodeDragStart:x,onNodeDragStop:$,onSelectionDrag:_,onSelectionDragStart:E,onSelectionDragStop:T,noPanClassName:A,nodeOrigin:D,rfId:B,autoPanOnConnect:F,autoPanOnNodeDrag:W,onError:X,connectionRadius:G,isValidConnection:K,nodeDragThreshold:ee})=>{const{setNodes:q,setEdges:he,setDefaultNodesAndEdges:ue,setMinZoom:ge,setMaxZoom:de,setTranslateExtent:ne,setNodeExtent:ye,reset:Q}=J(yi,ce),Z=oe();return w.useEffect(()=>{const ae=o?.map(Te=>({...Te,...V}));return ue(n,ae),()=>{Q()}},[]),Y("defaultEdgeOptions",V,Z.setState),Y("connectionMode",k,Z.setState),Y("onConnect",s,Z.setState),Y("onConnectStart",r,Z.setState),Y("onConnectEnd",i,Z.setState),Y("onClickConnectStart",c,Z.setState),Y("onClickConnectEnd",a,Z.setState),Y("nodesDraggable",d,Z.setState),Y("nodesConnectable",u,Z.setState),Y("nodesFocusable",f,Z.setState),Y("edgesFocusable",h,Z.setState),Y("edgesUpdatable",m,Z.setState),Y("elementsSelectable",p,Z.setState),Y("elevateNodesOnSelect",S,Z.setState),Y("snapToGrid",O,Z.setState),Y("snapGrid",R,Z.setState),Y("onNodesChange",v,Z.setState),Y("onEdgesChange",M,Z.setState),Y("connectOnClick",z,Z.setState),Y("fitViewOnInit",L,Z.setState),Y("fitViewOnInitOptions",j,Z.setState),Y("onNodesDelete",H,Z.setState),Y("onEdgesDelete",l,Z.setState),Y("onNodeDrag",N,Z.setState),Y("onNodeDragStart",x,Z.setState),Y("onNodeDragStop",$,Z.setState),Y("onSelectionDrag",_,Z.setState),Y("onSelectionDragStart",E,Z.setState),Y("onSelectionDragStop",T,Z.setState),Y("noPanClassName",A,Z.setState),Y("nodeOrigin",D,Z.setState),Y("rfId",B,Z.setState),Y("autoPanOnConnect",F,Z.setState),Y("autoPanOnNodeDrag",W,Z.setState),Y("onError",X,Z.setState),Y("connectionRadius",G,Z.setState),Y("isValidConnection",K,Z.setState),Y("nodeDragThreshold",ee,Z.setState),We(e,q),We(t,he),We(y,ge),We(b,de),We(P,ne),We(g,ye),null},On={display:"none"},wi={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},Bo="react-flow__node-desc",Uo="react-flow__edge-desc",Ei="react-flow__aria-live",bi=e=>e.ariaLiveMessage;function Si({rfId:e}){const t=J(bi);return C.createElement("div",{id:`${Ei}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:wi},t)}function vi({rfId:e,disableKeyboardA11y:t}){return C.createElement(C.Fragment,null,C.createElement("div",{id:`${Bo}-${e}`,style:On},"Press enter or space to select a node.",!t&&"You can then use the arrow keys to move the node around."," Press delete to remove it and escape to cancel."," "),C.createElement("div",{id:`${Uo}-${e}`,style:On},"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel."),!t&&C.createElement(Si,{rfId:e}))}var ht=(e=null,t={actInsideInputWithModifier:!0})=>{const[n,o]=w.useState(!1),s=w.useRef(!1),r=w.useRef(new Set([])),[i,c]=w.useMemo(()=>{if(e!==null){const d=(Array.isArray(e)?e:[e]).filter(f=>typeof f=="string").map(f=>f.split("+")),u=d.reduce((f,h)=>f.concat(...h),[]);return[d,u]}return[[],[]]},[e]);return w.useEffect(()=>{const a=typeof document<"u"?document:null,d=t?.target||a;if(e!==null){const u=m=>{if(s.current=m.ctrlKey||m.metaKey||m.shiftKey,(!s.current||s.current&&!t.actInsideInputWithModifier)&&Jt(m))return!1;const y=Ln(m.code,c);r.current.add(m[y]),Vn(i,r.current,!1)&&(m.preventDefault(),o(!0))},f=m=>{if((!s.current||s.current&&!t.actInsideInputWithModifier)&&Jt(m))return!1;const y=Ln(m.code,c);Vn(i,r.current,!0)?(o(!1),r.current.clear()):r.current.delete(m[y]),m.key==="Meta"&&r.current.clear(),s.current=!1},h=()=>{r.current.clear(),o(!1)};return d?.addEventListener("keydown",u),d?.addEventListener("keyup",f),window.addEventListener("blur",h),()=>{d?.removeEventListener("keydown",u),d?.removeEventListener("keyup",f),window.removeEventListener("blur",h)}}},[e,o]),n};function Vn(e,t,n){return e.filter(o=>n||o.length===t.size).some(o=>o.every(s=>t.has(s)))}function Ln(e,t){return t.includes(e)?"code":"key"}function Zo(e,t,n,o){const s=e.parentNode||e.parentId;if(!s)return n;const r=t.get(s),i=Qe(r,o);return Zo(r,t,{x:(n.x??0)+i.x,y:(n.y??0)+i.y,z:(r[te]?.z??0)>(n.z??0)?r[te]?.z??0:n.z??0},o)}function Wo(e,t,n){e.forEach(o=>{const s=o.parentNode||o.parentId;if(s&&!e.has(s))throw new Error(`Parent node ${s} not found`);if(s||n?.[o.id]){const{x:r,y:i,z:c}=Zo(o,e,{...o.position,z:o[te]?.z??0},t);o.positionAbsolute={x:r,y:i},o[te].z=c,n?.[o.id]&&(o[te].isParent=!0)}})}function Bt(e,t,n,o){const s=new Map,r={},i=o?1e3:0;return e.forEach(c=>{const a=(fe(c.zIndex)?c.zIndex:0)+(c.selected?i:0),d=t.get(c.id),u={...c,positionAbsolute:{x:c.position.x,y:c.position.y}},f=c.parentNode||c.parentId;f&&(r[f]=!0);const h=d?.type&&d?.type!==c.type;Object.defineProperty(u,te,{enumerable:!1,value:{handleBounds:h?void 0:d?.[te]?.handleBounds,z:a}}),s.set(c.id,u)}),Wo(s,n,r),s}function Yo(e,t={}){const{getNodes:n,width:o,height:s,minZoom:r,maxZoom:i,d3Zoom:c,d3Selection:a,fitViewOnInitDone:d,fitViewOnInit:u,nodeOrigin:f}=e(),h=t.initial&&!d&&u;if(c&&a&&(h||!t.initial)){const S=n().filter(b=>{const g=t.includeHiddenNodes?b.width&&b.height:!b.hidden;return t.nodes?.length?g&&t.nodes.some(v=>v.id===b.id):g}),y=S.every(b=>b.width&&b.height);if(S.length>0&&y){const b=Tt(S,f),{x:g,y:v,zoom:M}=Ao(b,o,s,t.minZoom??r,t.maxZoom??i,t.padding??.1),p=ke.translate(g,v).scale(M);return typeof t.duration=="number"&&t.duration>0?c.transform(He(a,t.duration),p):c.transform(a,p),!0}}return!1}function Ni(e,t){return e.forEach(n=>{const o=t.get(n.id);o&&t.set(o.id,{...o,[te]:o[te],selected:n.selected})}),new Map(t)}function Ci(e,t){return t.map(n=>{const o=e.find(s=>s.id===n.id);return o&&(n.selected=o.selected),n})}function wt({changedNodes:e,changedEdges:t,get:n,set:o}){const{nodeInternals:s,edges:r,onNodesChange:i,onEdgesChange:c,hasDefaultNodes:a,hasDefaultEdges:d}=n();e?.length&&(a&&o({nodeInternals:Ni(e,s)}),i?.(e)),t?.length&&(d&&o({edges:Ci(t,r)}),c?.(t))}const Ye=()=>{},Mi={zoomIn:Ye,zoomOut:Ye,zoomTo:Ye,getZoom:()=>1,setViewport:Ye,getViewport:()=>({x:0,y:0,zoom:1}),fitView:()=>!1,setCenter:Ye,fitBounds:Ye,project:e=>e,screenToFlowPosition:e=>e,flowToScreenPosition:e=>e,viewportInitialized:!1},$i=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection}),ki=()=>{const e=oe(),{d3Zoom:t,d3Selection:n}=J($i,ce);return w.useMemo(()=>n&&t?{zoomIn:s=>t.scaleBy(He(n,s?.duration),1.2),zoomOut:s=>t.scaleBy(He(n,s?.duration),1/1.2),zoomTo:(s,r)=>t.scaleTo(He(n,r?.duration),s),getZoom:()=>e.getState().transform[2],setViewport:(s,r)=>{const[i,c,a]=e.getState().transform,d=ke.translate(s.x??i,s.y??c).scale(s.zoom??a);t.transform(He(n,r?.duration),d)},getViewport:()=>{const[s,r,i]=e.getState().transform;return{x:s,y:r,zoom:i}},fitView:s=>Yo(e.getState,s),setCenter:(s,r,i)=>{const{width:c,height:a,maxZoom:d}=e.getState(),u=typeof i?.zoom<"u"?i.zoom:d,f=c/2-s*u,h=a/2-r*u,m=ke.translate(f,h).scale(u);t.transform(He(n,i?.duration),m)},fitBounds:(s,r)=>{const{width:i,height:c,minZoom:a,maxZoom:d}=e.getState(),{x:u,y:f,zoom:h}=Ao(s,i,c,a,d,r?.padding??.1),m=ke.translate(u,f).scale(h);t.transform(He(n,r?.duration),m)},project:s=>{const{transform:r,snapToGrid:i,snapGrid:c}=e.getState();return console.warn("[DEPRECATED] `project` is deprecated. Instead use `screenToFlowPosition`. There is no need to subtract the react flow bounds anymore! https://reactflow.dev/api-reference/types/react-flow-instance#screen-to-flow-position"),nn(s,r,i,c)},screenToFlowPosition:s=>{const{transform:r,snapToGrid:i,snapGrid:c,domNode:a}=e.getState();if(!a)return s;const{x:d,y:u}=a.getBoundingClientRect(),f={x:s.x-d,y:s.y-u};return nn(f,r,i,c)},flowToScreenPosition:s=>{const{transform:r,domNode:i}=e.getState();if(!i)return s;const{x:c,y:a}=i.getBoundingClientRect(),d=Ro(s,r);return{x:d.x+c,y:d.y+a}},viewportInitialized:!0}:Mi,[t,n])};function zt(){const e=ki(),t=oe(),n=w.useCallback(()=>t.getState().getNodes().map(y=>({...y})),[]),o=w.useCallback(y=>t.getState().nodeInternals.get(y),[]),s=w.useCallback(()=>{const{edges:y=[]}=t.getState();return y.map(b=>({...b}))},[]),r=w.useCallback(y=>{const{edges:b=[]}=t.getState();return b.find(g=>g.id===y)},[]),i=w.useCallback(y=>{const{getNodes:b,setNodes:g,hasDefaultNodes:v,onNodesChange:M}=t.getState(),p=b(),k=typeof y=="function"?y(p):y;if(v)g(k);else if(M){const R=k.length===0?p.map(O=>({type:"remove",id:O.id})):k.map(O=>({item:O,type:"reset"}));M(R)}},[]),c=w.useCallback(y=>{const{edges:b=[],setEdges:g,hasDefaultEdges:v,onEdgesChange:M}=t.getState(),p=typeof y=="function"?y(b):y;if(v)g(p);else if(M){const k=p.length===0?b.map(R=>({type:"remove",id:R.id})):p.map(R=>({item:R,type:"reset"}));M(k)}},[]),a=w.useCallback(y=>{const b=Array.isArray(y)?y:[y],{getNodes:g,setNodes:v,hasDefaultNodes:M,onNodesChange:p}=t.getState();if(M){const R=[...g(),...b];v(R)}else if(p){const k=b.map(R=>({item:R,type:"add"}));p(k)}},[]),d=w.useCallback(y=>{const b=Array.isArray(y)?y:[y],{edges:g=[],setEdges:v,hasDefaultEdges:M,onEdgesChange:p}=t.getState();if(M)v([...g,...b]);else if(p){const k=b.map(R=>({item:R,type:"add"}));p(k)}},[]),u=w.useCallback(()=>{const{getNodes:y,edges:b=[],transform:g}=t.getState(),[v,M,p]=g;return{nodes:y().map(k=>({...k})),edges:b.map(k=>({...k})),viewport:{x:v,y:M,zoom:p}}},[]),f=w.useCallback(({nodes:y,edges:b})=>{const{nodeInternals:g,getNodes:v,edges:M,hasDefaultNodes:p,hasDefaultEdges:k,onNodesDelete:R,onEdgesDelete:O,onNodesChange:P,onEdgesChange:z}=t.getState(),V=(y||[]).map(N=>N.id),L=(b||[]).map(N=>N.id),j=v().reduce((N,x)=>{const $=x.parentNode||x.parentId,_=!V.includes(x.id)&&$&&N.find(T=>T.id===$);return(typeof x.deletable=="boolean"?x.deletable:!0)&&(V.includes(x.id)||_)&&N.push(x),N},[]),H=M.filter(N=>typeof N.deletable=="boolean"?N.deletable:!0),l=H.filter(N=>L.includes(N.id));if(j||l){const N=zo(j,H),x=[...l,...N],$=x.reduce((_,E)=>(_.includes(E.id)||_.push(E.id),_),[]);if((k||p)&&(k&&t.setState({edges:M.filter(_=>!$.includes(_.id))}),p&&(j.forEach(_=>{g.delete(_.id)}),t.setState({nodeInternals:new Map(g)}))),$.length>0&&(O?.(x),z&&z($.map(_=>({id:_,type:"remove"})))),j.length>0&&(R?.(j),P)){const _=j.map(E=>({id:E.id,type:"remove"}));P(_)}}},[]),h=w.useCallback(y=>{const b=Yr(y),g=b?null:t.getState().nodeInternals.get(y.id);return!b&&!g?[null,null,b]:[b?y:zn(g),g,b]},[]),m=w.useCallback((y,b=!0,g)=>{const[v,M,p]=h(y);return v?(g||t.getState().getNodes()).filter(k=>{if(!p&&(k.id===M.id||!k.positionAbsolute))return!1;const R=zn(k),O=Qt(R,v);return b&&O>0||O>=v.width*v.height}):[]},[]),S=w.useCallback((y,b,g=!0)=>{const[v]=h(y);if(!v)return!1;const M=Qt(v,b);return g&&M>0||M>=v.width*v.height},[]);return w.useMemo(()=>({...e,getNodes:n,getNode:o,getEdges:s,getEdge:r,setNodes:i,setEdges:c,addNodes:a,addEdges:d,toObject:u,deleteElements:f,getIntersectingNodes:m,isNodeIntersecting:S}),[e,n,o,s,r,i,c,a,d,u,f,m,S])}const Ri={actInsideInputWithModifier:!1};var Ti=({deleteKeyCode:e,multiSelectionKeyCode:t})=>{const n=oe(),{deleteElements:o}=zt(),s=ht(e,Ri),r=ht(t);w.useEffect(()=>{if(s){const{edges:i,getNodes:c}=n.getState(),a=c().filter(u=>u.selected),d=i.filter(u=>u.selected);o({nodes:a,edges:d}),n.setState({nodesSelectionActive:!1})}},[s]),w.useEffect(()=>{n.setState({multiSelectionActive:r})},[r])};function zi(e){const t=oe();w.useEffect(()=>{let n;const o=()=>{if(!e.current)return;const s=an(e.current);(s.height===0||s.width===0)&&t.getState().onError?.("004",Ce.error004()),t.setState({width:s.width||500,height:s.height||500})};return o(),window.addEventListener("resize",o),e.current&&(n=new ResizeObserver(()=>o()),n.observe(e.current)),()=>{window.removeEventListener("resize",o),n&&e.current&&n.unobserve(e.current)}},[])}const yn={position:"absolute",width:"100%",height:"100%",top:0,left:0},Ai=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,Et=e=>({x:e.x,y:e.y,zoom:e.k}),Xe=(e,t)=>e.target.closest(`.${t}`),jn=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Fn=e=>{const t=e.ctrlKey&&St()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t},_i=e=>({d3Zoom:e.d3Zoom,d3Selection:e.d3Selection,d3ZoomHandler:e.d3ZoomHandler,userSelectionActive:e.userSelectionActive}),Ii=({onMove:e,onMoveStart:t,onMoveEnd:n,onPaneContextMenu:o,zoomOnScroll:s=!0,zoomOnPinch:r=!0,panOnScroll:i=!1,panOnScrollSpeed:c=.5,panOnScrollMode:a=Oe.Free,zoomOnDoubleClick:d=!0,elementsSelectable:u,panOnDrag:f=!0,defaultViewport:h,translateExtent:m,minZoom:S,maxZoom:y,zoomActivationKeyCode:b,preventScrolling:g=!0,children:v,noWheelClassName:M,noPanClassName:p})=>{const k=w.useRef(),R=oe(),O=w.useRef(!1),P=w.useRef(!1),z=w.useRef(null),V=w.useRef({x:0,y:0,zoom:0}),{d3Zoom:L,d3Selection:j,d3ZoomHandler:H,userSelectionActive:l}=J(_i,ce),N=ht(b),x=w.useRef(0),$=w.useRef(!1),_=w.useRef();return zi(z),w.useEffect(()=>{if(z.current){const E=z.current.getBoundingClientRect(),T=Vr().scaleExtent([S,y]).translateExtent(m),A=me(z.current).call(T),D=ke.translate(h.x,h.y).scale(tt(h.zoom,S,y)),B=[[0,0],[E.width,E.height]],F=T.constrain()(D,B,m);T.transform(A,F),T.wheelDelta(Fn),R.setState({d3Zoom:T,d3Selection:A,d3ZoomHandler:A.on("wheel.zoom"),transform:[F.x,F.y,F.k],domNode:z.current.closest(".react-flow")})}},[]),w.useEffect(()=>{j&&L&&(i&&!N&&!l?j.on("wheel.zoom",E=>{if(Xe(E,M))return!1;E.preventDefault(),E.stopImmediatePropagation();const T=j.property("__zoom").k||1;if(E.ctrlKey&&r){const K=Ee(E),ee=Fn(E),q=T*Math.pow(2,ee);L.scaleTo(j,q,K,E);return}const A=E.deltaMode===1?20:1;let D=a===Oe.Vertical?0:E.deltaX*A,B=a===Oe.Horizontal?0:E.deltaY*A;!St()&&E.shiftKey&&a!==Oe.Vertical&&(D=E.deltaY*A,B=0),L.translateBy(j,-(D/T)*c,-(B/T)*c,{internal:!0});const F=Et(j.property("__zoom")),{onViewportChangeStart:W,onViewportChange:X,onViewportChangeEnd:G}=R.getState();clearTimeout(_.current),$.current||($.current=!0,t?.(E,F),W?.(F)),$.current&&(e?.(E,F),X?.(F),_.current=setTimeout(()=>{n?.(E,F),G?.(F),$.current=!1},150))},{passive:!1}):typeof H<"u"&&j.on("wheel.zoom",function(E,T){if(!g&&E.type==="wheel"&&!E.ctrlKey||Xe(E,M))return null;E.preventDefault(),H.call(this,E,T)},{passive:!1}))},[l,i,a,j,L,H,N,r,g,M,t,e,n]),w.useEffect(()=>{L&&L.on("start",E=>{if(!E.sourceEvent||E.sourceEvent.internal)return null;x.current=E.sourceEvent?.button;const{onViewportChangeStart:T}=R.getState(),A=Et(E.transform);O.current=!0,V.current=A,E.sourceEvent?.type==="mousedown"&&R.setState({paneDragging:!0}),T?.(A),t?.(E.sourceEvent,A)})},[L,t]),w.useEffect(()=>{L&&(l&&!O.current?L.on("zoom",null):l||L.on("zoom",E=>{const{onViewportChange:T}=R.getState();if(R.setState({transform:[E.transform.x,E.transform.y,E.transform.k]}),P.current=!!(o&&jn(f,x.current??0)),(e||T)&&!E.sourceEvent?.internal){const A=Et(E.transform);T?.(A),e?.(E.sourceEvent,A)}}))},[l,L,e,f,o]),w.useEffect(()=>{L&&L.on("end",E=>{if(!E.sourceEvent||E.sourceEvent.internal)return null;const{onViewportChangeEnd:T}=R.getState();if(O.current=!1,R.setState({paneDragging:!1}),o&&jn(f,x.current??0)&&!P.current&&o(E.sourceEvent),P.current=!1,(n||T)&&Ai(V.current,E.transform)){const A=Et(E.transform);V.current=A,clearTimeout(k.current),k.current=setTimeout(()=>{T?.(A),n?.(E.sourceEvent,A)},i?150:0)}})},[L,i,f,n,o]),w.useEffect(()=>{L&&L.filter(E=>{const T=N||s,A=r&&E.ctrlKey;if((f===!0||Array.isArray(f)&&f.includes(1))&&E.button===1&&E.type==="mousedown"&&(Xe(E,"react-flow__node")||Xe(E,"react-flow__edge")))return!0;if(!f&&!T&&!i&&!d&&!r||l||!d&&E.type==="dblclick"||Xe(E,M)&&E.type==="wheel"||Xe(E,p)&&(E.type!=="wheel"||i&&E.type==="wheel"&&!N)||!r&&E.ctrlKey&&E.type==="wheel"||!T&&!i&&!A&&E.type==="wheel"||!f&&(E.type==="mousedown"||E.type==="touchstart")||Array.isArray(f)&&!f.includes(E.button)&&E.type==="mousedown")return!1;const D=Array.isArray(f)&&f.includes(E.button)||!E.button||E.button<=1;return(!E.ctrlKey||E.type==="wheel")&&D})},[l,L,s,r,i,d,f,u,N]),C.createElement("div",{className:"react-flow__renderer",ref:z,style:yn},v)},Di=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Pi(){const{userSelectionActive:e,userSelectionRect:t}=J(Di,ce);return e&&t?C.createElement("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}function Bn(e,t){const n=t.parentNode||t.parentId,o=e.find(s=>s.id===n);if(o){const s=t.position.x+t.width-o.width,r=t.position.y+t.height-o.height;if(s>0||r>0||t.position.x<0||t.position.y<0){if(o.style={...o.style},o.style.width=o.style.width??o.width,o.style.height=o.style.height??o.height,s>0&&(o.style.width+=s),r>0&&(o.style.height+=r),t.position.x<0){const i=Math.abs(t.position.x);o.position.x=o.position.x-i,o.style.width+=i,t.position.x=0}if(t.position.y<0){const i=Math.abs(t.position.y);o.position.y=o.position.y-i,o.style.height+=i,t.position.y=0}o.width=o.style.width,o.height=o.style.height}}}function Hi(e,t){if(e.some(o=>o.type==="reset"))return e.filter(o=>o.type==="reset").map(o=>o.item);const n=e.filter(o=>o.type==="add").map(o=>o.item);return t.reduce((o,s)=>{const r=e.filter(c=>c.id===s.id);if(r.length===0)return o.push(s),o;const i={...s};for(const c of r)if(c)switch(c.type){case"select":{i.selected=c.selected;break}case"position":{typeof c.position<"u"&&(i.position=c.position),typeof c.positionAbsolute<"u"&&(i.positionAbsolute=c.positionAbsolute),typeof c.dragging<"u"&&(i.dragging=c.dragging),i.expandParent&&Bn(o,i);break}case"dimensions":{typeof c.dimensions<"u"&&(i.width=c.dimensions.width,i.height=c.dimensions.height),typeof c.updateStyle<"u"&&(i.style={...i.style||{},...c.dimensions}),typeof c.resizing=="boolean"&&(i.resizing=c.resizing),i.expandParent&&Bn(o,i);break}case"remove":return o}return o.push(i),o},n)}function Oi(e,t){return Hi(e,t)}const $e=(e,t)=>({id:e,type:"select",selected:t});function Ke(e,t){return e.reduce((n,o)=>{const s=t.includes(o.id);return!o.selected&&s?(o.selected=!0,n.push($e(o.id,!0))):o.selected&&!s&&(o.selected=!1,n.push($e(o.id,!1))),n},[])}const Ut=(e,t)=>n=>{n.target===t.current&&e?.(n)},Vi=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,dragging:e.paneDragging}),Xo=w.memo(({isSelecting:e,selectionMode:t=ft.Full,panOnDrag:n,onSelectionStart:o,onSelectionEnd:s,onPaneClick:r,onPaneContextMenu:i,onPaneScroll:c,onPaneMouseEnter:a,onPaneMouseMove:d,onPaneMouseLeave:u,children:f})=>{const h=w.useRef(null),m=oe(),S=w.useRef(0),y=w.useRef(0),b=w.useRef(),{userSelectionActive:g,elementsSelectable:v,dragging:M}=J(Vi,ce),p=()=>{m.setState({userSelectionActive:!1,userSelectionRect:null}),S.current=0,y.current=0},k=H=>{r?.(H),m.getState().resetSelectedElements(),m.setState({nodesSelectionActive:!1})},R=H=>{if(Array.isArray(n)&&n?.includes(2)){H.preventDefault();return}i?.(H)},O=c?H=>c(H):void 0,P=H=>{const{resetSelectedElements:l,domNode:N}=m.getState();if(b.current=N?.getBoundingClientRect(),!v||!e||H.button!==0||H.target!==h.current||!b.current)return;const{x,y:$}=Re(H,b.current);l(),m.setState({userSelectionRect:{width:0,height:0,startX:x,startY:$,x,y:$}}),o?.(H)},z=H=>{const{userSelectionRect:l,nodeInternals:N,edges:x,transform:$,onNodesChange:_,onEdgesChange:E,nodeOrigin:T,getNodes:A}=m.getState();if(!e||!b.current||!l)return;m.setState({userSelectionActive:!0,nodesSelectionActive:!1});const D=Re(H,b.current),B=l.startX??0,F=l.startY??0,W={...l,x:D.x<B?D.x:B,y:D.y<F?D.y:F,width:Math.abs(D.x-B),height:Math.abs(D.y-F)},X=A(),G=To(N,W,$,t===ft.Partial,!0,T),K=zo(G,x).map(q=>q.id),ee=G.map(q=>q.id);if(S.current!==ee.length){S.current=ee.length;const q=Ke(X,ee);q.length&&_?.(q)}if(y.current!==K.length){y.current=K.length;const q=Ke(x,K);q.length&&E?.(q)}m.setState({userSelectionRect:W})},V=H=>{if(H.button!==0)return;const{userSelectionRect:l}=m.getState();!g&&l&&H.target===h.current&&k?.(H),m.setState({nodesSelectionActive:S.current>0}),p(),s?.(H)},L=H=>{g&&(m.setState({nodesSelectionActive:S.current>0}),s?.(H)),p()},j=v&&(e||g);return C.createElement("div",{className:re(["react-flow__pane",{dragging:M,selection:e}]),onClick:j?void 0:Ut(k,h),onContextMenu:Ut(R,h),onWheel:Ut(O,h),onMouseEnter:j?void 0:a,onMouseDown:j?P:void 0,onMouseMove:j?z:d,onMouseUp:j?V:void 0,onMouseLeave:j?L:u,ref:h,style:yn},f,C.createElement(Pi,null))});Xo.displayName="Pane";function Go(e,t){const n=e.parentNode||e.parentId;if(!n)return!1;const o=t.get(n);return o?o.selected?!0:Go(o,t):!1}function Un(e,t,n){let o=e;do{if(o?.matches(t))return!0;if(o===n.current)return!1;o=o.parentElement}while(o);return!1}function Li(e,t,n,o){return Array.from(e.values()).filter(s=>(s.selected||s.id===o)&&(!s.parentNode||s.parentId||!Go(s,e))&&(s.draggable||t&&typeof s.draggable>"u")).map(s=>({id:s.id,position:s.position||{x:0,y:0},positionAbsolute:s.positionAbsolute||{x:0,y:0},distance:{x:n.x-(s.positionAbsolute?.x??0),y:n.y-(s.positionAbsolute?.y??0)},delta:{x:0,y:0},extent:s.extent,parentNode:s.parentNode||s.parentId,parentId:s.parentNode||s.parentId,width:s.width,height:s.height,expandParent:s.expandParent}))}function ji(e,t){return!t||t==="parent"?t:[t[0],[t[1][0]-(e.width||0),t[1][1]-(e.height||0)]]}function Ko(e,t,n,o,s=[0,0],r){const i=ji(e,e.extent||o);let c=i;const a=e.parentNode||e.parentId;if(e.extent==="parent"&&!e.expandParent)if(a&&e.width&&e.height){const f=n.get(a),{x:h,y:m}=Qe(f,s).positionAbsolute;c=f&&fe(h)&&fe(m)&&fe(f.width)&&fe(f.height)?[[h+e.width*s[0],m+e.height*s[1]],[h+f.width-e.width+e.width*s[0],m+f.height-e.height+e.height*s[1]]]:c}else r?.("005",Ce.error005()),c=i;else if(e.extent&&a&&e.extent!=="parent"){const f=n.get(a),{x:h,y:m}=Qe(f,s).positionAbsolute;c=[[e.extent[0][0]+h,e.extent[0][1]+m],[e.extent[1][0]+h,e.extent[1][1]+m]]}let d={x:0,y:0};if(a){const f=n.get(a);d=Qe(f,s).positionAbsolute}const u=c&&c!=="parent"?ln(t,c):t;return{position:{x:u.x-d.x,y:u.y-d.y},positionAbsolute:u}}function Zt({nodeId:e,dragItems:t,nodeInternals:n}){const o=t.map(s=>({...n.get(s.id),position:s.position,positionAbsolute:s.positionAbsolute}));return[e?o.find(s=>s.id===e):o[0],o]}const Zn=(e,t,n,o)=>{const s=t.querySelectorAll(e);if(!s||!s.length)return null;const r=Array.from(s),i=t.getBoundingClientRect(),c={x:i.width*o[0],y:i.height*o[1]};return r.map(a=>{const d=a.getBoundingClientRect();return{id:a.getAttribute("data-handleid"),position:a.getAttribute("data-handlepos"),x:(d.left-i.left-c.x)/n,y:(d.top-i.top-c.y)/n,...an(a)}})};function ct(e,t,n){return n===void 0?n:o=>{const s=t().nodeInternals.get(e);s&&n(o,{...s})}}function sn({id:e,store:t,unselect:n=!1,nodeRef:o}){const{addSelectedNodes:s,unselectNodesAndEdges:r,multiSelectionActive:i,nodeInternals:c,onError:a}=t.getState(),d=c.get(e);if(!d){a?.("012",Ce.error012(e));return}t.setState({nodesSelectionActive:!1}),d.selected?(n||d.selected&&i)&&(r({nodes:[d],edges:[]}),requestAnimationFrame(()=>o?.current?.blur())):s([e])}function Fi(){const e=oe();return w.useCallback(({sourceEvent:n})=>{const{transform:o,snapGrid:s,snapToGrid:r}=e.getState(),i=n.touches?n.touches[0].clientX:n.clientX,c=n.touches?n.touches[0].clientY:n.clientY,a={x:(i-o[0])/o[2],y:(c-o[1])/o[2]};return{xSnapped:r?s[0]*Math.round(a.x/s[0]):a.x,ySnapped:r?s[1]*Math.round(a.y/s[1]):a.y,...a}},[])}function Wt(e){return(t,n,o)=>e?.(t,o)}function qo({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:o,nodeId:s,isSelectable:r,selectNodesOnDrag:i}){const c=oe(),[a,d]=w.useState(!1),u=w.useRef([]),f=w.useRef({x:null,y:null}),h=w.useRef(0),m=w.useRef(null),S=w.useRef({x:0,y:0}),y=w.useRef(null),b=w.useRef(!1),g=w.useRef(!1),v=w.useRef(!1),M=Fi();return w.useEffect(()=>{if(e?.current){const p=me(e.current),k=({x:P,y:z})=>{const{nodeInternals:V,onNodeDrag:L,onSelectionDrag:j,updateNodePositions:H,nodeExtent:l,snapGrid:N,snapToGrid:x,nodeOrigin:$,onError:_}=c.getState();f.current={x:P,y:z};let E=!1,T={x:0,y:0,x2:0,y2:0};if(u.current.length>1&&l){const D=Tt(u.current,$);T=un(D)}if(u.current=u.current.map(D=>{const B={x:P-D.distance.x,y:z-D.distance.y};x&&(B.x=N[0]*Math.round(B.x/N[0]),B.y=N[1]*Math.round(B.y/N[1]));const F=[[l[0][0],l[0][1]],[l[1][0],l[1][1]]];u.current.length>1&&l&&!D.extent&&(F[0][0]=D.positionAbsolute.x-T.x+l[0][0],F[1][0]=D.positionAbsolute.x+(D.width??0)-T.x2+l[1][0],F[0][1]=D.positionAbsolute.y-T.y+l[0][1],F[1][1]=D.positionAbsolute.y+(D.height??0)-T.y2+l[1][1]);const W=Ko(D,B,V,F,$,_);return E=E||D.position.x!==W.position.x||D.position.y!==W.position.y,D.position=W.position,D.positionAbsolute=W.positionAbsolute,D}),!E)return;H(u.current,!0,!0),d(!0);const A=s?L:Wt(j);if(A&&y.current){const[D,B]=Zt({nodeId:s,dragItems:u.current,nodeInternals:V});A(y.current,D,B)}},R=()=>{if(!m.current)return;const[P,z]=bo(S.current,m.current);if(P!==0||z!==0){const{transform:V,panBy:L}=c.getState();f.current.x=(f.current.x??0)-P/V[2],f.current.y=(f.current.y??0)-z/V[2],L({x:P,y:z})&&k(f.current)}h.current=requestAnimationFrame(R)},O=P=>{const{nodeInternals:z,multiSelectionActive:V,nodesDraggable:L,unselectNodesAndEdges:j,onNodeDragStart:H,onSelectionDragStart:l}=c.getState();g.current=!0;const N=s?H:Wt(l);(!i||!r)&&!V&&s&&(z.get(s)?.selected||j()),s&&r&&i&&sn({id:s,store:c,nodeRef:e});const x=M(P);if(f.current=x,u.current=Li(z,L,x,s),N&&u.current){const[$,_]=Zt({nodeId:s,dragItems:u.current,nodeInternals:z});N(P.sourceEvent,$,_)}};if(t)p.on(".drag",null);else{const P=kr().on("start",z=>{const{domNode:V,nodeDragThreshold:L}=c.getState();L===0&&O(z),v.current=!1;const j=M(z);f.current=j,m.current=V?.getBoundingClientRect()||null,S.current=Re(z.sourceEvent,m.current)}).on("drag",z=>{const V=M(z),{autoPanOnNodeDrag:L,nodeDragThreshold:j}=c.getState();if(z.sourceEvent.type==="touchmove"&&z.sourceEvent.touches.length>1&&(v.current=!0),!v.current){if(!b.current&&g.current&&L&&(b.current=!0,R()),!g.current){const H=V.xSnapped-(f?.current?.x??0),l=V.ySnapped-(f?.current?.y??0);Math.sqrt(H*H+l*l)>j&&O(z)}(f.current.x!==V.xSnapped||f.current.y!==V.ySnapped)&&u.current&&g.current&&(y.current=z.sourceEvent,S.current=Re(z.sourceEvent,m.current),k(V))}}).on("end",z=>{if(!(!g.current||v.current)&&(d(!1),b.current=!1,g.current=!1,cancelAnimationFrame(h.current),u.current)){const{updateNodePositions:V,nodeInternals:L,onNodeDragStop:j,onSelectionDragStop:H}=c.getState(),l=s?j:Wt(H);if(V(u.current,!1,!1),l){const[N,x]=Zt({nodeId:s,dragItems:u.current,nodeInternals:L});l(z.sourceEvent,N,x)}}}).filter(z=>{const V=z.target;return!z.button&&(!n||!Un(V,`.${n}`,e))&&(!o||Un(V,o,e))});return p.call(P),()=>{p.on(".drag",null)}}}},[e,t,n,o,r,c,s,i,M]),a}function Qo(){const e=oe();return w.useCallback(n=>{const{nodeInternals:o,nodeExtent:s,updateNodePositions:r,getNodes:i,snapToGrid:c,snapGrid:a,onError:d,nodesDraggable:u}=e.getState(),f=i().filter(v=>v.selected&&(v.draggable||u&&typeof v.draggable>"u")),h=c?a[0]:5,m=c?a[1]:5,S=n.isShiftPressed?4:1,y=n.x*h*S,b=n.y*m*S,g=f.map(v=>{if(v.positionAbsolute){const M={x:v.positionAbsolute.x+y,y:v.positionAbsolute.y+b};c&&(M.x=a[0]*Math.round(M.x/a[0]),M.y=a[1]*Math.round(M.y/a[1]));const{positionAbsolute:p,position:k}=Ko(v,M,o,s,void 0,d);v.position=k,v.positionAbsolute=p}return v});r(g,!0,!1)},[])}const Je={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}};var at=e=>{const t=({id:n,type:o,data:s,xPos:r,yPos:i,xPosOrigin:c,yPosOrigin:a,selected:d,onClick:u,onMouseEnter:f,onMouseMove:h,onMouseLeave:m,onContextMenu:S,onDoubleClick:y,style:b,className:g,isDraggable:v,isSelectable:M,isConnectable:p,isFocusable:k,selectNodesOnDrag:R,sourcePosition:O,targetPosition:P,hidden:z,resizeObserver:V,dragHandle:L,zIndex:j,isParent:H,noDragClassName:l,noPanClassName:N,initialized:x,disableKeyboardA11y:$,ariaLabel:_,rfId:E,hasHandleBounds:T})=>{const A=oe(),D=w.useRef(null),B=w.useRef(null),F=w.useRef(O),W=w.useRef(P),X=w.useRef(o),G=M||v||u||f||h||m,K=Qo(),ee=ct(n,A.getState,f),q=ct(n,A.getState,h),he=ct(n,A.getState,m),ue=ct(n,A.getState,S),ge=ct(n,A.getState,y),de=Q=>{const{nodeDragThreshold:Z}=A.getState();if(M&&(!R||!v||Z>0)&&sn({id:n,store:A,nodeRef:D}),u){const ae=A.getState().nodeInternals.get(n);ae&&u(Q,{...ae})}},ne=Q=>{if(!Jt(Q)&&!$)if(vo.includes(Q.key)&&M){const Z=Q.key==="Escape";sn({id:n,store:A,unselect:Z,nodeRef:D})}else v&&d&&Object.prototype.hasOwnProperty.call(Je,Q.key)&&(A.setState({ariaLiveMessage:`Moved selected node ${Q.key.replace("Arrow","").toLowerCase()}. New position, x: ${~~r}, y: ${~~i}`}),K({x:Je[Q.key].x,y:Je[Q.key].y,isShiftPressed:Q.shiftKey}))};w.useEffect(()=>()=>{B.current&&(V?.unobserve(B.current),B.current=null)},[]),w.useEffect(()=>{if(D.current&&!z){const Q=D.current;(!x||!T||B.current!==Q)&&(B.current&&V?.unobserve(B.current),V?.observe(Q),B.current=Q)}},[z,x,T]),w.useEffect(()=>{const Q=X.current!==o,Z=F.current!==O,ae=W.current!==P;D.current&&(Q||Z||ae)&&(Q&&(X.current=o),Z&&(F.current=O),ae&&(W.current=P),A.getState().updateNodeDimensions([{id:n,nodeElement:D.current,forceUpdate:!0}]))},[n,o,O,P]);const ye=qo({nodeRef:D,disabled:z||!v,noDragClassName:l,handleSelector:L,nodeId:n,isSelectable:M,selectNodesOnDrag:R});return z?null:C.createElement("div",{className:re(["react-flow__node",`react-flow__node-${o}`,{[N]:v},g,{selected:d,selectable:M,parent:H,dragging:ye}]),ref:D,style:{zIndex:j,transform:`translate(${c}px,${a}px)`,pointerEvents:G?"all":"none",visibility:x?"visible":"hidden",...b},"data-id":n,"data-testid":`rf__node-${n}`,onMouseEnter:ee,onMouseMove:q,onMouseLeave:he,onContextMenu:ue,onClick:de,onDoubleClick:ge,onKeyDown:k?ne:void 0,tabIndex:k?0:void 0,role:k?"button":void 0,"aria-describedby":$?void 0:`${Bo}-${E}`,"aria-label":_},C.createElement(ei,{value:n},C.createElement(e,{id:n,data:s,type:o,xPos:r,yPos:i,selected:d,isConnectable:p,sourcePosition:O,targetPosition:P,dragging:ye,dragHandle:L,zIndex:j})))};return t.displayName="NodeWrapper",w.memo(t)};const Bi=e=>{const t=e.getNodes().filter(n=>n.selected);return{...Tt(t,e.nodeOrigin),transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`,userSelectionActive:e.userSelectionActive}};function Ui({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const o=oe(),{width:s,height:r,x:i,y:c,transformString:a,userSelectionActive:d}=J(Bi,ce),u=Qo(),f=w.useRef(null);if(w.useEffect(()=>{n||f.current?.focus({preventScroll:!0})},[n]),qo({nodeRef:f}),d||!s||!r)return null;const h=e?S=>{const y=o.getState().getNodes().filter(b=>b.selected);e(S,y)}:void 0,m=S=>{Object.prototype.hasOwnProperty.call(Je,S.key)&&u({x:Je[S.key].x,y:Je[S.key].y,isShiftPressed:S.shiftKey})};return C.createElement("div",{className:re(["react-flow__nodesselection","react-flow__container",t]),style:{transform:a}},C.createElement("div",{ref:f,className:"react-flow__nodesselection-rect",onContextMenu:h,tabIndex:n?void 0:-1,onKeyDown:n?void 0:m,style:{width:s,height:r,top:c,left:i}}))}var Zi=w.memo(Ui);const Wi=e=>e.nodesSelectionActive,Jo=({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,deleteKeyCode:c,onMove:a,onMoveStart:d,onMoveEnd:u,selectionKeyCode:f,selectionOnDrag:h,selectionMode:m,onSelectionStart:S,onSelectionEnd:y,multiSelectionKeyCode:b,panActivationKeyCode:g,zoomActivationKeyCode:v,elementsSelectable:M,zoomOnScroll:p,zoomOnPinch:k,panOnScroll:R,panOnScrollSpeed:O,panOnScrollMode:P,zoomOnDoubleClick:z,panOnDrag:V,defaultViewport:L,translateExtent:j,minZoom:H,maxZoom:l,preventScrolling:N,onSelectionContextMenu:x,noWheelClassName:$,noPanClassName:_,disableKeyboardA11y:E})=>{const T=J(Wi),A=ht(f),D=ht(g),B=D||V,F=D||R,W=A||h&&B!==!0;return Ti({deleteKeyCode:c,multiSelectionKeyCode:b}),C.createElement(Ii,{onMove:a,onMoveStart:d,onMoveEnd:u,onPaneContextMenu:r,elementsSelectable:M,zoomOnScroll:p,zoomOnPinch:k,panOnScroll:F,panOnScrollSpeed:O,panOnScrollMode:P,zoomOnDoubleClick:z,panOnDrag:!A&&B,defaultViewport:L,translateExtent:j,minZoom:H,maxZoom:l,zoomActivationKeyCode:v,preventScrolling:N,noWheelClassName:$,noPanClassName:_},C.createElement(Xo,{onSelectionStart:S,onSelectionEnd:y,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:o,onPaneMouseLeave:s,onPaneContextMenu:r,onPaneScroll:i,panOnDrag:B,isSelecting:!!W,selectionMode:m},e,T&&C.createElement(Zi,{onSelectionContextMenu:x,noPanClassName:_,disableKeyboardA11y:E})))};Jo.displayName="FlowRenderer";var Yi=w.memo(Jo);function Xi(e){return J(w.useCallback(n=>e?To(n.nodeInternals,{x:0,y:0,width:n.width,height:n.height},n.transform,!0):n.getNodes(),[e]))}function Gi(e){const t={input:at(e.input||Vo),default:at(e.default||on),output:at(e.output||jo),group:at(e.group||pn)},n={},o=Object.keys(e).filter(s=>!["input","default","output","group"].includes(s)).reduce((s,r)=>(s[r]=at(e[r]||on),s),n);return{...t,...o}}const Ki=({x:e,y:t,width:n,height:o,origin:s})=>!n||!o?{x:e,y:t}:s[0]<0||s[1]<0||s[0]>1||s[1]>1?{x:e,y:t}:{x:e-n*s[0],y:t-o*s[1]},qi=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,updateNodeDimensions:e.updateNodeDimensions,onError:e.onError}),es=e=>{const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:o,elementsSelectable:s,updateNodeDimensions:r,onError:i}=J(qi,ce),c=Xi(e.onlyRenderVisibleElements),a=w.useRef(),d=w.useMemo(()=>{if(typeof ResizeObserver>"u")return null;const u=new ResizeObserver(f=>{const h=f.map(m=>({id:m.target.getAttribute("data-id"),nodeElement:m.target,forceUpdate:!0}));r(h)});return a.current=u,u},[]);return w.useEffect(()=>()=>{a?.current?.disconnect()},[]),C.createElement("div",{className:"react-flow__nodes",style:yn},c.map(u=>{let f=u.type||"default";e.nodeTypes[f]||(i?.("003",Ce.error003(f)),f="default");const h=e.nodeTypes[f]||e.nodeTypes.default,m=!!(u.draggable||t&&typeof u.draggable>"u"),S=!!(u.selectable||s&&typeof u.selectable>"u"),y=!!(u.connectable||n&&typeof u.connectable>"u"),b=!!(u.focusable||o&&typeof u.focusable>"u"),g=e.nodeExtent?ln(u.positionAbsolute,e.nodeExtent):u.positionAbsolute,v=g?.x??0,M=g?.y??0,p=Ki({x:v,y:M,width:u.width??0,height:u.height??0,origin:e.nodeOrigin});return C.createElement(h,{key:u.id,id:u.id,className:u.className,style:u.style,type:f,data:u.data,sourcePosition:u.sourcePosition||U.Bottom,targetPosition:u.targetPosition||U.Top,hidden:u.hidden,xPos:v,yPos:M,xPosOrigin:p.x,yPosOrigin:p.y,selectNodesOnDrag:e.selectNodesOnDrag,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,selected:!!u.selected,isDraggable:m,isSelectable:S,isConnectable:y,isFocusable:b,resizeObserver:d,dragHandle:u.dragHandle,zIndex:u[te]?.z??0,isParent:!!u[te]?.isParent,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,initialized:!!u.width&&!!u.height,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,ariaLabel:u.ariaLabel,hasHandleBounds:!!u[te]?.handleBounds})}))};es.displayName="NodeRenderer";var Qi=w.memo(es);const Ji=(e,t,n)=>n===U.Left?e-t:n===U.Right?e+t:e,ec=(e,t,n)=>n===U.Top?e-t:n===U.Bottom?e+t:e,Wn="react-flow__edgeupdater",Yn=({position:e,centerX:t,centerY:n,radius:o=10,onMouseDown:s,onMouseEnter:r,onMouseOut:i,type:c})=>C.createElement("circle",{onMouseDown:s,onMouseEnter:r,onMouseOut:i,className:re([Wn,`${Wn}-${c}`]),cx:Ji(t,o,e),cy:ec(n,o,e),r:o,stroke:"transparent",fill:"transparent"}),tc=()=>!0;var Ge=e=>{const t=({id:n,className:o,type:s,data:r,onClick:i,onEdgeDoubleClick:c,selected:a,animated:d,label:u,labelStyle:f,labelShowBg:h,labelBgStyle:m,labelBgPadding:S,labelBgBorderRadius:y,style:b,source:g,target:v,sourceX:M,sourceY:p,targetX:k,targetY:R,sourcePosition:O,targetPosition:P,elementsSelectable:z,hidden:V,sourceHandleId:L,targetHandleId:j,onContextMenu:H,onMouseEnter:l,onMouseMove:N,onMouseLeave:x,reconnectRadius:$,onReconnect:_,onReconnectStart:E,onReconnectEnd:T,markerEnd:A,markerStart:D,rfId:B,ariaLabel:F,isFocusable:W,isReconnectable:X,pathOptions:G,interactionWidth:K,disableKeyboardA11y:ee})=>{const q=w.useRef(null),[he,ue]=w.useState(!1),[ge,de]=w.useState(!1),ne=oe(),ye=w.useMemo(()=>`url('#${tn(D,B)}')`,[D,B]),Q=w.useMemo(()=>`url('#${tn(A,B)}')`,[A,B]);if(V)return null;const Z=se=>{const{edges:xe,addSelectedEdges:_e,unselectNodesAndEdges:Ie,multiSelectionActive:Ze}=ne.getState(),we=xe.find(De=>De.id===n);we&&(z&&(ne.setState({nodesSelectionActive:!1}),we.selected&&Ze?(Ie({nodes:[],edges:[we]}),q.current?.blur()):_e([n])),i&&i(se,we))},ae=it(n,ne.getState,c),Te=it(n,ne.getState,H),nt=it(n,ne.getState,l),Le=it(n,ne.getState,N),je=it(n,ne.getState,x),Se=(se,xe)=>{if(se.button!==0)return;const{edges:_e,isValidConnection:Ie}=ne.getState(),Ze=xe?v:g,we=(xe?j:L)||null,De=xe?"target":"source",_t=Ie||tc,It=xe,st=_e.find(Pe=>Pe.id===n);de(!0),E?.(se,st,De);const Dt=Pe=>{de(!1),T?.(Pe,st,De)};Do({event:se,handleId:we,nodeId:Ze,onConnect:Pe=>_?.(st,Pe),isTarget:It,getState:ne.getState,setState:ne.setState,isValidConnection:_t,edgeUpdaterType:De,onReconnectEnd:Dt})},Fe=se=>Se(se,!0),ze=se=>Se(se,!1),Ae=()=>ue(!0),Be=()=>ue(!1),Ue=!z&&!i,ot=se=>{if(!ee&&vo.includes(se.key)&&z){const{unselectNodesAndEdges:xe,addSelectedEdges:_e,edges:Ie}=ne.getState();se.key==="Escape"?(q.current?.blur(),xe({edges:[Ie.find(we=>we.id===n)]})):_e([n])}};return C.createElement("g",{className:re(["react-flow__edge",`react-flow__edge-${s}`,o,{selected:a,animated:d,inactive:Ue,updating:he}]),onClick:Z,onDoubleClick:ae,onContextMenu:Te,onMouseEnter:nt,onMouseMove:Le,onMouseLeave:je,onKeyDown:W?ot:void 0,tabIndex:W?0:void 0,role:W?"button":"img","data-testid":`rf__edge-${n}`,"aria-label":F===null?void 0:F||`Edge from ${g} to ${v}`,"aria-describedby":W?`${Uo}-${B}`:void 0,ref:q},!ge&&C.createElement(e,{id:n,source:g,target:v,selected:a,animated:d,label:u,labelStyle:f,labelShowBg:h,labelBgStyle:m,labelBgPadding:S,labelBgBorderRadius:y,data:r,style:b,sourceX:M,sourceY:p,targetX:k,targetY:R,sourcePosition:O,targetPosition:P,sourceHandleId:L,targetHandleId:j,markerStart:ye,markerEnd:Q,pathOptions:G,interactionWidth:K}),X&&C.createElement(C.Fragment,null,(X==="source"||X===!0)&&C.createElement(Yn,{position:O,centerX:M,centerY:p,radius:$,onMouseDown:Fe,onMouseEnter:Ae,onMouseOut:Be,type:"source"}),(X==="target"||X===!0)&&C.createElement(Yn,{position:P,centerX:k,centerY:R,radius:$,onMouseDown:ze,onMouseEnter:Ae,onMouseOut:Be,type:"target"})))};return t.displayName="EdgeWrapper",w.memo(t)};function nc(e){const t={default:Ge(e.default||Nt),straight:Ge(e.bezier||hn),step:Ge(e.step||fn),smoothstep:Ge(e.step||Rt),simplebezier:Ge(e.simplebezier||dn)},n={},o=Object.keys(e).filter(s=>!["default","bezier"].includes(s)).reduce((s,r)=>(s[r]=Ge(e[r]||Nt),s),n);return{...t,...o}}function Xn(e,t,n=null){const o=(n?.x||0)+t.x,s=(n?.y||0)+t.y,r=n?.width||t.width,i=n?.height||t.height;switch(e){case U.Top:return{x:o+r/2,y:s};case U.Right:return{x:o+r,y:s+i/2};case U.Bottom:return{x:o+r/2,y:s+i};case U.Left:return{x:o,y:s+i/2}}}function Gn(e,t){return e?e.length===1||!t?e[0]:t&&e.find(n=>n.id===t)||null:null}const oc=(e,t,n,o,s,r)=>{const i=Xn(n,e,t),c=Xn(r,o,s);return{sourceX:i.x,sourceY:i.y,targetX:c.x,targetY:c.y}};function sc({sourcePos:e,targetPos:t,sourceWidth:n,sourceHeight:o,targetWidth:s,targetHeight:r,width:i,height:c,transform:a}){const d={x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x+n,t.x+s),y2:Math.max(e.y+o,t.y+r)};d.x===d.x2&&(d.x2+=1),d.y===d.y2&&(d.y2+=1);const u=un({x:(0-a[0])/a[2],y:(0-a[1])/a[2],width:i/a[2],height:c/a[2]}),f=Math.max(0,Math.min(u.x2,d.x2)-Math.max(u.x,d.x)),h=Math.max(0,Math.min(u.y2,d.y2)-Math.max(u.y,d.y));return Math.ceil(f*h)>0}function Kn(e){const t=e?.[te]?.handleBounds||null,n=t&&e?.width&&e?.height&&typeof e?.positionAbsolute?.x<"u"&&typeof e?.positionAbsolute?.y<"u";return[{x:e?.positionAbsolute?.x||0,y:e?.positionAbsolute?.y||0,width:e?.width||0,height:e?.height||0},t,!!n]}const rc=[{level:0,isMaxLevel:!0,edges:[]}];function ic(e,t,n=!1){let o=-1;const s=e.reduce((i,c)=>{const a=fe(c.zIndex);let d=a?c.zIndex:0;if(n){const u=t.get(c.target),f=t.get(c.source),h=c.selected||u?.selected||f?.selected,m=Math.max(f?.[te]?.z||0,u?.[te]?.z||0,1e3);d=(a?c.zIndex:0)+(h?m:0)}return i[d]?i[d].push(c):i[d]=[c],o=d>o?d:o,i},{}),r=Object.entries(s).map(([i,c])=>{const a=+i;return{edges:c,level:a,isMaxLevel:a===o}});return r.length===0?rc:r}function cc(e,t,n){const o=J(w.useCallback(s=>e?s.edges.filter(r=>{const i=t.get(r.source),c=t.get(r.target);return i?.width&&i?.height&&c?.width&&c?.height&&sc({sourcePos:i.positionAbsolute||{x:0,y:0},targetPos:c.positionAbsolute||{x:0,y:0},sourceWidth:i.width,sourceHeight:i.height,targetWidth:c.width,targetHeight:c.height,width:s.width,height:s.height,transform:s.transform})}):s.edges,[e,t]));return ic(o,t,n)}const ac=({color:e="none",strokeWidth:t=1})=>C.createElement("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),lc=({color:e="none",strokeWidth:t=1})=>C.createElement("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),qn={[vt.Arrow]:ac,[vt.ArrowClosed]:lc};function uc(e){const t=oe();return w.useMemo(()=>Object.prototype.hasOwnProperty.call(qn,e)?qn[e]:(t.getState().onError?.("009",Ce.error009(e)),null),[e])}const dc=({id:e,type:t,color:n,width:o=12.5,height:s=12.5,markerUnits:r="strokeWidth",strokeWidth:i,orient:c="auto-start-reverse"})=>{const a=uc(t);return a?C.createElement("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${o}`,markerHeight:`${s}`,viewBox:"-10 -10 20 20",markerUnits:r,orient:c,refX:"0",refY:"0"},C.createElement(a,{color:n,strokeWidth:i})):null},fc=({defaultColor:e,rfId:t})=>n=>{const o=[];return n.edges.reduce((s,r)=>([r.markerStart,r.markerEnd].forEach(i=>{if(i&&typeof i=="object"){const c=tn(i,t);o.includes(c)||(s.push({id:c,color:i.color||e,...i}),o.push(c))}}),s),[]).sort((s,r)=>s.id.localeCompare(r.id))},ts=({defaultColor:e,rfId:t})=>{const n=J(w.useCallback(fc({defaultColor:e,rfId:t}),[e,t]),(o,s)=>!(o.length!==s.length||o.some((r,i)=>r.id!==s[i].id)));return C.createElement("defs",null,n.map(o=>C.createElement(dc,{id:o.id,key:o.id,type:o.type,color:o.color,width:o.width,height:o.height,markerUnits:o.markerUnits,strokeWidth:o.strokeWidth,orient:o.orient})))};ts.displayName="MarkerDefinitions";var hc=w.memo(ts);const gc=e=>({nodesConnectable:e.nodesConnectable,edgesFocusable:e.edgesFocusable,edgesUpdatable:e.edgesUpdatable,elementsSelectable:e.elementsSelectable,width:e.width,height:e.height,connectionMode:e.connectionMode,nodeInternals:e.nodeInternals,onError:e.onError}),ns=({defaultMarkerColor:e,onlyRenderVisibleElements:t,elevateEdgesOnSelect:n,rfId:o,edgeTypes:s,noPanClassName:r,onEdgeContextMenu:i,onEdgeMouseEnter:c,onEdgeMouseMove:a,onEdgeMouseLeave:d,onEdgeClick:u,onEdgeDoubleClick:f,onReconnect:h,onReconnectStart:m,onReconnectEnd:S,reconnectRadius:y,children:b,disableKeyboardA11y:g})=>{const{edgesFocusable:v,edgesUpdatable:M,elementsSelectable:p,width:k,height:R,connectionMode:O,nodeInternals:P,onError:z}=J(gc,ce),V=cc(t,P,n);return k?C.createElement(C.Fragment,null,V.map(({level:L,edges:j,isMaxLevel:H})=>C.createElement("svg",{key:L,style:{zIndex:L},width:k,height:R,className:"react-flow__edges react-flow__container"},H&&C.createElement(hc,{defaultColor:e,rfId:o}),C.createElement("g",null,j.map(l=>{const[N,x,$]=Kn(P.get(l.source)),[_,E,T]=Kn(P.get(l.target));if(!$||!T)return null;let A=l.type||"default";s[A]||(z?.("011",Ce.error011(A)),A="default");const D=s[A]||s.default,B=O===Ve.Strict?E.target:(E.target??[]).concat(E.source??[]),F=Gn(x.source,l.sourceHandle),W=Gn(B,l.targetHandle),X=F?.position||U.Bottom,G=W?.position||U.Top,K=!!(l.focusable||v&&typeof l.focusable>"u"),ee=l.reconnectable||l.updatable,q=typeof h<"u"&&(ee||M&&typeof ee>"u");if(!F||!W)return z?.("008",Ce.error008(F,l)),null;const{sourceX:he,sourceY:ue,targetX:ge,targetY:de}=oc(N,F,X,_,W,G);return C.createElement(D,{key:l.id,id:l.id,className:re([l.className,r]),type:A,data:l.data,selected:!!l.selected,animated:!!l.animated,hidden:!!l.hidden,label:l.label,labelStyle:l.labelStyle,labelShowBg:l.labelShowBg,labelBgStyle:l.labelBgStyle,labelBgPadding:l.labelBgPadding,labelBgBorderRadius:l.labelBgBorderRadius,style:l.style,source:l.source,target:l.target,sourceHandleId:l.sourceHandle,targetHandleId:l.targetHandle,markerEnd:l.markerEnd,markerStart:l.markerStart,sourceX:he,sourceY:ue,targetX:ge,targetY:de,sourcePosition:X,targetPosition:G,elementsSelectable:p,onContextMenu:i,onMouseEnter:c,onMouseMove:a,onMouseLeave:d,onClick:u,onEdgeDoubleClick:f,onReconnect:h,onReconnectStart:m,onReconnectEnd:S,reconnectRadius:y,rfId:o,ariaLabel:l.ariaLabel,isFocusable:K,isReconnectable:q,pathOptions:"pathOptions"in l?l.pathOptions:void 0,interactionWidth:l.interactionWidth,disableKeyboardA11y:g})})))),b):null};ns.displayName="EdgeRenderer";var mc=w.memo(ns);const pc=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function yc({children:e}){const t=J(pc);return C.createElement("div",{className:"react-flow__viewport react-flow__container",style:{transform:t}},e)}function xc(e){const t=zt(),n=w.useRef(!1);w.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const wc={[U.Left]:U.Right,[U.Right]:U.Left,[U.Top]:U.Bottom,[U.Bottom]:U.Top},os=({nodeId:e,handleType:t,style:n,type:o=ve.Bezier,CustomComponent:s,connectionStatus:r})=>{const{fromNode:i,handleId:c,toX:a,toY:d,connectionMode:u}=J(w.useCallback(R=>({fromNode:R.nodeInternals.get(e),handleId:R.connectionHandleId,toX:(R.connectionPosition.x-R.transform[0])/R.transform[2],toY:(R.connectionPosition.y-R.transform[1])/R.transform[2],connectionMode:R.connectionMode}),[e]),ce),f=i?.[te]?.handleBounds;let h=f?.[t];if(u===Ve.Loose&&(h=h||f?.[t==="source"?"target":"source"]),!i||!h)return null;const m=c?h.find(R=>R.id===c):h[0],S=m?m.x+m.width/2:(i.width??0)/2,y=m?m.y+m.height/2:i.height??0,b=(i.positionAbsolute?.x??0)+S,g=(i.positionAbsolute?.y??0)+y,v=m?.position,M=v?wc[v]:null;if(!v||!M)return null;if(s)return C.createElement(s,{connectionLineType:o,connectionLineStyle:n,fromNode:i,fromHandle:m,fromX:b,fromY:g,toX:a,toY:d,fromPosition:v,toPosition:M,connectionStatus:r});let p="";const k={sourceX:b,sourceY:g,sourcePosition:v,targetX:a,targetY:d,targetPosition:M};return o===ve.Bezier?[p]=ko(k):o===ve.Step?[p]=en({...k,borderRadius:0}):o===ve.SmoothStep?[p]=en(k):o===ve.SimpleBezier?[p]=$o(k):p=`M${b},${g} ${a},${d}`,C.createElement("path",{d:p,fill:"none",className:"react-flow__connection-path",style:n})};os.displayName="ConnectionLine";const Ec=e=>({nodeId:e.connectionNodeId,handleType:e.connectionHandleType,nodesConnectable:e.nodesConnectable,connectionStatus:e.connectionStatus,width:e.width,height:e.height});function bc({containerStyle:e,style:t,type:n,component:o}){const{nodeId:s,handleType:r,nodesConnectable:i,width:c,height:a,connectionStatus:d}=J(Ec,ce);return!(s&&r&&c&&i)?null:C.createElement("svg",{style:e,width:c,height:a,className:"react-flow__edges react-flow__connectionline react-flow__container"},C.createElement("g",{className:re(["react-flow__connection",d])},C.createElement(os,{nodeId:s,handleType:r,style:t,type:n,CustomComponent:o,connectionStatus:d})))}function Qn(e,t){return w.useRef(null),oe(),w.useMemo(()=>t(e),[e])}const ss=({nodeTypes:e,edgeTypes:t,onMove:n,onMoveStart:o,onMoveEnd:s,onInit:r,onNodeClick:i,onEdgeClick:c,onNodeDoubleClick:a,onEdgeDoubleClick:d,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:h,onNodeContextMenu:m,onSelectionContextMenu:S,onSelectionStart:y,onSelectionEnd:b,connectionLineType:g,connectionLineStyle:v,connectionLineComponent:M,connectionLineContainerStyle:p,selectionKeyCode:k,selectionOnDrag:R,selectionMode:O,multiSelectionKeyCode:P,panActivationKeyCode:z,zoomActivationKeyCode:V,deleteKeyCode:L,onlyRenderVisibleElements:j,elementsSelectable:H,selectNodesOnDrag:l,defaultViewport:N,translateExtent:x,minZoom:$,maxZoom:_,preventScrolling:E,defaultMarkerColor:T,zoomOnScroll:A,zoomOnPinch:D,panOnScroll:B,panOnScrollSpeed:F,panOnScrollMode:W,zoomOnDoubleClick:X,panOnDrag:G,onPaneClick:K,onPaneMouseEnter:ee,onPaneMouseMove:q,onPaneMouseLeave:he,onPaneScroll:ue,onPaneContextMenu:ge,onEdgeContextMenu:de,onEdgeMouseEnter:ne,onEdgeMouseMove:ye,onEdgeMouseLeave:Q,onReconnect:Z,onReconnectStart:ae,onReconnectEnd:Te,reconnectRadius:nt,noDragClassName:Le,noWheelClassName:je,noPanClassName:Se,elevateEdgesOnSelect:Fe,disableKeyboardA11y:ze,nodeOrigin:Ae,nodeExtent:Be,rfId:Ue})=>{const ot=Qn(e,Gi),se=Qn(t,nc);return xc(r),C.createElement(Yi,{onPaneClick:K,onPaneMouseEnter:ee,onPaneMouseMove:q,onPaneMouseLeave:he,onPaneContextMenu:ge,onPaneScroll:ue,deleteKeyCode:L,selectionKeyCode:k,selectionOnDrag:R,selectionMode:O,onSelectionStart:y,onSelectionEnd:b,multiSelectionKeyCode:P,panActivationKeyCode:z,zoomActivationKeyCode:V,elementsSelectable:H,onMove:n,onMoveStart:o,onMoveEnd:s,zoomOnScroll:A,zoomOnPinch:D,zoomOnDoubleClick:X,panOnScroll:B,panOnScrollSpeed:F,panOnScrollMode:W,panOnDrag:G,defaultViewport:N,translateExtent:x,minZoom:$,maxZoom:_,onSelectionContextMenu:S,preventScrolling:E,noDragClassName:Le,noWheelClassName:je,noPanClassName:Se,disableKeyboardA11y:ze},C.createElement(yc,null,C.createElement(mc,{edgeTypes:se,onEdgeClick:c,onEdgeDoubleClick:d,onlyRenderVisibleElements:j,onEdgeContextMenu:de,onEdgeMouseEnter:ne,onEdgeMouseMove:ye,onEdgeMouseLeave:Q,onReconnect:Z,onReconnectStart:ae,onReconnectEnd:Te,reconnectRadius:nt,defaultMarkerColor:T,noPanClassName:Se,elevateEdgesOnSelect:!!Fe,disableKeyboardA11y:ze,rfId:Ue},C.createElement(bc,{style:v,type:g,component:M,containerStyle:p})),C.createElement("div",{className:"react-flow__edgelabel-renderer"}),C.createElement(Qi,{nodeTypes:ot,onNodeClick:i,onNodeDoubleClick:a,onNodeMouseEnter:u,onNodeMouseMove:f,onNodeMouseLeave:h,onNodeContextMenu:m,selectNodesOnDrag:l,onlyRenderVisibleElements:j,noPanClassName:Se,noDragClassName:Le,disableKeyboardA11y:ze,nodeOrigin:Ae,nodeExtent:Be,rfId:Ue})))};ss.displayName="GraphView";var Sc=w.memo(ss);const rn=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Me={rfId:"1",width:0,height:0,transform:[0,0,1],nodeInternals:new Map,edges:[],onNodesChange:null,onEdgesChange:null,hasDefaultNodes:!1,hasDefaultEdges:!1,d3Zoom:null,d3Selection:null,d3ZoomHandler:void 0,minZoom:.5,maxZoom:2,translateExtent:rn,nodeExtent:rn,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionNodeId:null,connectionHandleId:null,connectionHandleType:"source",connectionPosition:{x:0,y:0},connectionStatus:null,connectionMode:Ve.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:[0,0],nodeDragThreshold:0,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesUpdatable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,fitViewOnInit:!1,fitViewOnInitDone:!1,fitViewOnInitOptions:void 0,onSelectionChange:[],multiSelectionActive:!1,connectionStartHandle:null,connectionEndHandle:null,connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,connectionRadius:20,onError:Xr,isValidConnection:void 0},vc=()=>br((e,t)=>({...Me,setNodes:n=>{const{nodeInternals:o,nodeOrigin:s,elevateNodesOnSelect:r}=t();e({nodeInternals:Bt(n,o,s,r)})},getNodes:()=>Array.from(t().nodeInternals.values()),setEdges:n=>{const{defaultEdgeOptions:o={}}=t();e({edges:n.map(s=>({...o,...s}))})},setDefaultNodesAndEdges:(n,o)=>{const s=typeof n<"u",r=typeof o<"u",i=s?Bt(n,new Map,t().nodeOrigin,t().elevateNodesOnSelect):new Map;e({nodeInternals:i,edges:r?o:[],hasDefaultNodes:s,hasDefaultEdges:r})},updateNodeDimensions:n=>{const{onNodesChange:o,nodeInternals:s,fitViewOnInit:r,fitViewOnInitDone:i,fitViewOnInitOptions:c,domNode:a,nodeOrigin:d}=t(),u=a?.querySelector(".react-flow__viewport");if(!u)return;const f=window.getComputedStyle(u),{m22:h}=new window.DOMMatrixReadOnly(f.transform),m=n.reduce((y,b)=>{const g=s.get(b.id);if(g?.hidden)s.set(g.id,{...g,[te]:{...g[te],handleBounds:void 0}});else if(g){const v=an(b.nodeElement);!!(v.width&&v.height&&(g.width!==v.width||g.height!==v.height||b.forceUpdate))&&(s.set(g.id,{...g,[te]:{...g[te],handleBounds:{source:Zn(".source",b.nodeElement,h,d),target:Zn(".target",b.nodeElement,h,d)}},...v}),y.push({id:g.id,type:"dimensions",dimensions:v}))}return y},[]);Wo(s,d);const S=i||r&&!i&&Yo(t,{initial:!0,...c});e({nodeInternals:new Map(s),fitViewOnInitDone:S}),m?.length>0&&o?.(m)},updateNodePositions:(n,o=!0,s=!1)=>{const{triggerNodeChanges:r}=t(),i=n.map(c=>{const a={id:c.id,type:"position",dragging:s};return o&&(a.positionAbsolute=c.positionAbsolute,a.position=c.position),a});r(i)},triggerNodeChanges:n=>{const{onNodesChange:o,nodeInternals:s,hasDefaultNodes:r,nodeOrigin:i,getNodes:c,elevateNodesOnSelect:a}=t();if(n?.length){if(r){const d=Oi(n,c()),u=Bt(d,s,i,a);e({nodeInternals:u})}o?.(n)}},addSelectedNodes:n=>{const{multiSelectionActive:o,edges:s,getNodes:r}=t();let i,c=null;o?i=n.map(a=>$e(a,!0)):(i=Ke(r(),n),c=Ke(s,[])),wt({changedNodes:i,changedEdges:c,get:t,set:e})},addSelectedEdges:n=>{const{multiSelectionActive:o,edges:s,getNodes:r}=t();let i,c=null;o?i=n.map(a=>$e(a,!0)):(i=Ke(s,n),c=Ke(r(),[])),wt({changedNodes:c,changedEdges:i,get:t,set:e})},unselectNodesAndEdges:({nodes:n,edges:o}={})=>{const{edges:s,getNodes:r}=t(),i=n||r(),c=o||s,a=i.map(u=>(u.selected=!1,$e(u.id,!1))),d=c.map(u=>$e(u.id,!1));wt({changedNodes:a,changedEdges:d,get:t,set:e})},setMinZoom:n=>{const{d3Zoom:o,maxZoom:s}=t();o?.scaleExtent([n,s]),e({minZoom:n})},setMaxZoom:n=>{const{d3Zoom:o,minZoom:s}=t();o?.scaleExtent([s,n]),e({maxZoom:n})},setTranslateExtent:n=>{t().d3Zoom?.translateExtent(n),e({translateExtent:n})},resetSelectedElements:()=>{const{edges:n,getNodes:o}=t(),r=o().filter(c=>c.selected).map(c=>$e(c.id,!1)),i=n.filter(c=>c.selected).map(c=>$e(c.id,!1));wt({changedNodes:r,changedEdges:i,get:t,set:e})},setNodeExtent:n=>{const{nodeInternals:o}=t();o.forEach(s=>{s.positionAbsolute=ln(s.position,n)}),e({nodeExtent:n,nodeInternals:new Map(o)})},panBy:n=>{const{transform:o,width:s,height:r,d3Zoom:i,d3Selection:c,translateExtent:a}=t();if(!i||!c||!n.x&&!n.y)return!1;const d=ke.translate(o[0]+n.x,o[1]+n.y).scale(o[2]),u=[[0,0],[s,r]],f=i?.constrain()(d,u,a);return i.transform(c,f),o[0]!==f.x||o[1]!==f.y||o[2]!==f.k},cancelConnection:()=>e({connectionNodeId:Me.connectionNodeId,connectionHandleId:Me.connectionHandleId,connectionHandleType:Me.connectionHandleType,connectionStatus:Me.connectionStatus,connectionStartHandle:Me.connectionStartHandle,connectionEndHandle:Me.connectionEndHandle}),reset:()=>e({...Me})}),Object.is),xn=({children:e})=>{const t=w.useRef(null);return t.current||(t.current=vc()),C.createElement(Lr,{value:t.current},e)};xn.displayName="ReactFlowProvider";const rs=({children:e})=>w.useContext(kt)?C.createElement(C.Fragment,null,e):C.createElement(xn,null,e);rs.displayName="ReactFlowWrapper";const Nc={input:Vo,default:on,output:jo,group:pn},Cc={default:Nt,straight:hn,step:fn,smoothstep:Rt,simplebezier:dn},Mc=[0,0],$c=[15,15],kc={x:0,y:0,zoom:1},Rc={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0},is=w.forwardRef(({nodes:e,edges:t,defaultNodes:n,defaultEdges:o,className:s,nodeTypes:r=Nc,edgeTypes:i=Cc,onNodeClick:c,onEdgeClick:a,onInit:d,onMove:u,onMoveStart:f,onMoveEnd:h,onConnect:m,onConnectStart:S,onConnectEnd:y,onClickConnectStart:b,onClickConnectEnd:g,onNodeMouseEnter:v,onNodeMouseMove:M,onNodeMouseLeave:p,onNodeContextMenu:k,onNodeDoubleClick:R,onNodeDragStart:O,onNodeDrag:P,onNodeDragStop:z,onNodesDelete:V,onEdgesDelete:L,onSelectionChange:j,onSelectionDragStart:H,onSelectionDrag:l,onSelectionDragStop:N,onSelectionContextMenu:x,onSelectionStart:$,onSelectionEnd:_,connectionMode:E=Ve.Strict,connectionLineType:T=ve.Bezier,connectionLineStyle:A,connectionLineComponent:D,connectionLineContainerStyle:B,deleteKeyCode:F="Backspace",selectionKeyCode:W="Shift",selectionOnDrag:X=!1,selectionMode:G=ft.Full,panActivationKeyCode:K="Space",multiSelectionKeyCode:ee=St()?"Meta":"Control",zoomActivationKeyCode:q=St()?"Meta":"Control",snapToGrid:he=!1,snapGrid:ue=$c,onlyRenderVisibleElements:ge=!1,selectNodesOnDrag:de=!0,nodesDraggable:ne,nodesConnectable:ye,nodesFocusable:Q,nodeOrigin:Z=Mc,edgesFocusable:ae,edgesUpdatable:Te,elementsSelectable:nt,defaultViewport:Le=kc,minZoom:je=.5,maxZoom:Se=2,translateExtent:Fe=rn,preventScrolling:ze=!0,nodeExtent:Ae,defaultMarkerColor:Be="#b1b1b7",zoomOnScroll:Ue=!0,zoomOnPinch:ot=!0,panOnScroll:se=!1,panOnScrollSpeed:xe=.5,panOnScrollMode:_e=Oe.Free,zoomOnDoubleClick:Ie=!0,panOnDrag:Ze=!0,onPaneClick:we,onPaneMouseEnter:De,onPaneMouseMove:_t,onPaneMouseLeave:It,onPaneScroll:st,onPaneContextMenu:Dt,children:bn,onEdgeContextMenu:Pe,onEdgeDoubleClick:ps,onEdgeMouseEnter:ys,onEdgeMouseMove:xs,onEdgeMouseLeave:ws,onEdgeUpdate:Es,onEdgeUpdateStart:bs,onEdgeUpdateEnd:Ss,onReconnect:vs,onReconnectStart:Ns,onReconnectEnd:Cs,reconnectRadius:Ms=10,edgeUpdaterRadius:$s=10,onNodesChange:ks,onEdgesChange:Rs,noDragClassName:Ts="nodrag",noWheelClassName:zs="nowheel",noPanClassName:Sn="nopan",fitView:As=!1,fitViewOptions:_s,connectOnClick:Is=!0,attributionPosition:Ds,proOptions:Ps,defaultEdgeOptions:Hs,elevateNodesOnSelect:Os=!0,elevateEdgesOnSelect:Vs=!1,disableKeyboardA11y:vn=!1,autoPanOnConnect:Ls=!0,autoPanOnNodeDrag:js=!0,connectionRadius:Fs=20,isValidConnection:Bs,onError:Us,style:Zs,id:Nn,nodeDragThreshold:Ws,...Ys},Xs)=>{const Pt=Nn||"1";return C.createElement("div",{...Ys,style:{...Zs,...Rc},ref:Xs,className:re(["react-flow",s]),"data-testid":"rf__wrapper",id:Nn},C.createElement(rs,null,C.createElement(Sc,{onInit:d,onMove:u,onMoveStart:f,onMoveEnd:h,onNodeClick:c,onEdgeClick:a,onNodeMouseEnter:v,onNodeMouseMove:M,onNodeMouseLeave:p,onNodeContextMenu:k,onNodeDoubleClick:R,nodeTypes:r,edgeTypes:i,connectionLineType:T,connectionLineStyle:A,connectionLineComponent:D,connectionLineContainerStyle:B,selectionKeyCode:W,selectionOnDrag:X,selectionMode:G,deleteKeyCode:F,multiSelectionKeyCode:ee,panActivationKeyCode:K,zoomActivationKeyCode:q,onlyRenderVisibleElements:ge,selectNodesOnDrag:de,defaultViewport:Le,translateExtent:Fe,minZoom:je,maxZoom:Se,preventScrolling:ze,zoomOnScroll:Ue,zoomOnPinch:ot,zoomOnDoubleClick:Ie,panOnScroll:se,panOnScrollSpeed:xe,panOnScrollMode:_e,panOnDrag:Ze,onPaneClick:we,onPaneMouseEnter:De,onPaneMouseMove:_t,onPaneMouseLeave:It,onPaneScroll:st,onPaneContextMenu:Dt,onSelectionContextMenu:x,onSelectionStart:$,onSelectionEnd:_,onEdgeContextMenu:Pe,onEdgeDoubleClick:ps,onEdgeMouseEnter:ys,onEdgeMouseMove:xs,onEdgeMouseLeave:ws,onReconnect:vs??Es,onReconnectStart:Ns??bs,onReconnectEnd:Cs??Ss,reconnectRadius:Ms??$s,defaultMarkerColor:Be,noDragClassName:Ts,noWheelClassName:zs,noPanClassName:Sn,elevateEdgesOnSelect:Vs,rfId:Pt,disableKeyboardA11y:vn,nodeOrigin:Z,nodeExtent:Ae}),C.createElement(xi,{nodes:e,edges:t,defaultNodes:n,defaultEdges:o,onConnect:m,onConnectStart:S,onConnectEnd:y,onClickConnectStart:b,onClickConnectEnd:g,nodesDraggable:ne,nodesConnectable:ye,nodesFocusable:Q,edgesFocusable:ae,edgesUpdatable:Te,elementsSelectable:nt,elevateNodesOnSelect:Os,minZoom:je,maxZoom:Se,nodeExtent:Ae,onNodesChange:ks,onEdgesChange:Rs,snapToGrid:he,snapGrid:ue,connectionMode:E,translateExtent:Fe,connectOnClick:Is,defaultEdgeOptions:Hs,fitView:As,fitViewOptions:_s,onNodesDelete:V,onEdgesDelete:L,onNodeDragStart:O,onNodeDrag:P,onNodeDragStop:z,onSelectionDrag:l,onSelectionDragStart:H,onSelectionDragStop:N,noPanClassName:Sn,nodeOrigin:Z,rfId:Pt,autoPanOnConnect:Ls,autoPanOnNodeDrag:js,onError:Us,connectionRadius:Fs,isValidConnection:Bs,nodeDragThreshold:Ws}),C.createElement(pi,{onSelectionChange:j}),bn,C.createElement(Fr,{proOptions:Ps,position:Ds}),C.createElement(vi,{rfId:Pt,disableKeyboardA11y:vn})))});is.displayName="ReactFlow";function Tc(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}function zc(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32"},C.createElement("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"}))}function Ac(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5"},C.createElement("path",{d:"M0 0h32v4.2H0z"}))}function _c(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30"},C.createElement("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"}))}function Ic(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},C.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"}))}function Dc(){return C.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32"},C.createElement("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"}))}const lt=({children:e,className:t,...n})=>C.createElement("button",{type:"button",className:re(["react-flow__controls-button",t]),...n},e);lt.displayName="ControlButton";const Pc=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom}),cs=({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:o=!0,fitViewOptions:s,onZoomIn:r,onZoomOut:i,onFitView:c,onInteractiveChange:a,className:d,children:u,position:f="bottom-left"})=>{const h=oe(),[m,S]=w.useState(!1),{isInteractive:y,minZoomReached:b,maxZoomReached:g}=J(Pc,Tc),{zoomIn:v,zoomOut:M,fitView:p}=zt();if(w.useEffect(()=>{S(!0)},[]),!m)return null;const k=()=>{v(),r?.()},R=()=>{M(),i?.()},O=()=>{p(s),c?.()},P=()=>{h.setState({nodesDraggable:!y,nodesConnectable:!y,elementsSelectable:!y}),a?.(!y)};return C.createElement(dt,{className:re(["react-flow__controls",d]),position:f,style:e,"data-testid":"rf__controls"},t&&C.createElement(C.Fragment,null,C.createElement(lt,{onClick:k,className:"react-flow__controls-zoomin",title:"zoom in","aria-label":"zoom in",disabled:g},C.createElement(zc,null)),C.createElement(lt,{onClick:R,className:"react-flow__controls-zoomout",title:"zoom out","aria-label":"zoom out",disabled:b},C.createElement(Ac,null))),n&&C.createElement(lt,{className:"react-flow__controls-fitview",onClick:O,title:"fit view","aria-label":"fit view"},C.createElement(_c,null)),o&&C.createElement(lt,{className:"react-flow__controls-interactive",onClick:P,title:"toggle interactivity","aria-label":"toggle interactivity"},y?C.createElement(Dc,null):C.createElement(Ic,null)),u)};cs.displayName="Controls";var Hc=w.memo(cs);function Oc(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[o,s]of e)if(!Object.is(s,t.get(o)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const o of e)if(!t.has(o))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const o of n)if(!Object.prototype.hasOwnProperty.call(t,o)||!Object.is(e[o],t[o]))return!1;return!0}var pe;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(pe||(pe={}));function Vc({color:e,dimensions:t,lineWidth:n}){return C.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function Lc({color:e,radius:t}){return C.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const jc={[pe.Dots]:"#91919a",[pe.Lines]:"#eee",[pe.Cross]:"#e2e2e2"},Fc={[pe.Dots]:1,[pe.Lines]:1,[pe.Cross]:6},Bc=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function as({id:e,variant:t=pe.Dots,gap:n=20,size:o,lineWidth:s=1,offset:r=2,color:i,style:c,className:a}){const d=w.useRef(null),{transform:u,patternId:f}=J(Bc,Oc),h=i||jc[t],m=o||Fc[t],S=t===pe.Dots,y=t===pe.Cross,b=Array.isArray(n)?n:[n,n],g=[b[0]*u[2]||1,b[1]*u[2]||1],v=m*u[2],M=y?[v,v]:g,p=S?[v/r,v/r]:[M[0]/r,M[1]/r];return C.createElement("svg",{className:re(["react-flow__background",a]),style:{...c,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:d,"data-testid":"rf__background"},C.createElement("pattern",{id:f+e,x:u[0]%g[0],y:u[1]%g[1],width:g[0],height:g[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${p[0]},-${p[1]})`},S?C.createElement(Lc,{color:h,radius:v/r}):C.createElement(Vc,{dimensions:M,color:h,lineWidth:s})),C.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${f+e})`}))}as.displayName="Background";var Uc=w.memo(as);function Zc({title:e,titleId:t,...n},o){return w.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":t},n),e?w.createElement("title",{id:t},e):null,w.createElement("path",{d:"M2.5 3A1.5 1.5 0 0 0 1 4.5v.793c.026.009.051.02.076.032L7.674 8.51c.206.1.446.1.652 0l6.598-3.185A.755.755 0 0 1 15 5.293V4.5A1.5 1.5 0 0 0 13.5 3h-11Z"}),w.createElement("path",{d:"M15 6.954 8.978 9.86a2.25 2.25 0 0 1-1.956 0L1 6.954V11.5A1.5 1.5 0 0 0 2.5 13h11a1.5 1.5 0 0 0 1.5-1.5V6.954Z"}))}const ls=w.forwardRef(Zc);function Wc({title:e,titleId:t,...n},o){return w.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 16 16",fill:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":t},n),e?w.createElement("title",{id:t},e):null,w.createElement("path",{d:"M3.665 3.588A2 2 0 0 1 5.622 2h4.754a2 2 0 0 1 1.958 1.588l1.098 5.218a3.487 3.487 0 0 0-1.433-.306H4c-.51 0-.995.11-1.433.306l1.099-5.218Z"}),w.createElement("path",{fillRule:"evenodd",d:"M4 10a2 2 0 1 0 0 4h8a2 2 0 1 0 0-4H4Zm8 2.75a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5ZM9.75 12a.75.75 0 1 1-1.5 0 .75.75 0 0 1 1.5 0Z",clipRule:"evenodd"}))}const Yc=w.forwardRef(Wc);function Yt(...e){return e.filter(Boolean).join(" ")}function Xc({data:e,sourcePosition:t,targetPosition:n}){const{label:o,bgColor:s="bg-blue-500",mode:r,service:i,showTarget:c=!0,showSource:a=!0}=e,{version:d,owners:u=[],sends:f=[],receives:h=[],name:m}=i.data;return I.jsxs("div",{className:Yt("w-full rounded-md border flex justify-start  bg-white text-black border-pink-500"),children:[I.jsxs("div",{className:Yt("bg-gradient-to-b from-pink-500 to-pink-700 relative flex items-center w-5 justify-center rounded-l-sm text-red-100-500","border-r-[1px] border-pink-500"),children:[I.jsx(Yc,{className:"w-4 h-4 opacity-90 text-white absolute top-1 "}),r==="full"&&I.jsx("span",{className:"rotate -rotate-90 w-1/2 text-center absolute bottom-1 text-[9px] text-white font-bold uppercase tracking-[3px] ",children:"Service"})]}),I.jsxs("div",{className:"p-1 min-w-60 max-w-[min-content]",children:[c&&I.jsx(be,{type:"target",position:n}),a&&I.jsx(be,{type:"source",position:t}),I.jsxs("div",{className:Yt(r==="full"?"border-b border-gray-200":""),children:[I.jsx("span",{className:"text-xs font-bold block pt-0.5 pb-0.5",children:m}),I.jsxs("div",{className:"flex justify-between",children:[I.jsxs("span",{className:"text-[10px] font-light block pt-0.5 pb-0.5 ",children:["v",d]}),r==="simple"&&I.jsx("span",{className:"text-[10px] text-gray-500 font-light block pt-0.5 pb-0.5 ",children:"Service"})]})]}),r==="full"&&I.jsxs("div",{className:"divide-y divide-gray-200 ",children:[I.jsx("div",{className:"leading-3 py-1",children:I.jsx("span",{className:"text-[8px] font-light",children:i.data.summary})}),I.jsxs("div",{className:"grid grid-cols-2 gap-x-4 py-1",children:[I.jsxs("span",{className:"text-xs",style:{fontSize:"0.2em"},children:["Receives messages: ",h.length]}),I.jsxs("span",{className:"text-xs",style:{fontSize:"0.2em"},children:["Publishes messages: ",f.length]}),I.jsxs("span",{className:"text-xs",style:{fontSize:"0.2em"},children:["Owners: ",u.length]})]})]})]})]})}function Xt(...e){return e.filter(Boolean).join(" ")}function Gc({data:e,sourcePosition:t,targetPosition:n}){const{mode:o,message:s,showTarget:r=!0,showSource:i=!0}=e,{name:c,version:a,summary:d,owners:u=[],producers:f=[],consumers:h=[]}=s.data,m=r||n&&f.length>0,S=i||t&&h.length>0;return I.jsxs("div",{className:Xt("w-full rounded-md border flex justify-start  bg-white text-black border-orange-400"),children:[I.jsxs("div",{className:Xt("bg-gradient-to-b from-orange-500 to-orange-700 relative flex items-center w-5 justify-center rounded-l-sm text-orange-100-500","border-r-[1px] border-orange-500"),children:[I.jsx(ls,{className:"w-4 h-4 opacity-90 text-white absolute top-1 "}),o==="full"&&I.jsx("span",{className:"rotate -rotate-90 w-1/2 text-center absolute bottom-1 text-[9px] text-white font-bold uppercase tracking-[3px] ",children:"Event"})]}),I.jsxs("div",{className:"p-1 min-w-60 max-w-[min-content]",children:[m&&I.jsx(be,{type:"target",position:n}),S&&I.jsx(be,{type:"source",position:t}),I.jsxs("div",{className:Xt(o==="full"?"border-b border-gray-200":""),children:[I.jsx("span",{className:"text-xs font-bold block pb-0.5",children:c}),I.jsxs("div",{className:"flex justify-between",children:[I.jsxs("span",{className:"text-[10px] font-light block pt-0.5 pb-0.5 ",children:["v",a]}),o==="simple"&&I.jsx("span",{className:"text-[10px] text-gray-500 font-light block pt-0.5 pb-0.5 ",children:"Event"})]})]}),o==="full"&&I.jsxs("div",{className:"divide-y divide-gray-200 ",children:[I.jsx("div",{className:"leading-3 py-1",children:I.jsx("span",{className:"text-[8px] font-light",children:d})}),I.jsxs("div",{className:"grid grid-cols-2 gap-x-4 py-1",children:[I.jsxs("span",{className:"text-xs",style:{fontSize:"0.2em"},children:["Producers: ",f.length]}),I.jsxs("span",{className:"text-xs",style:{fontSize:"0.2em"},children:["Consumers: ",h.length]}),I.jsxs("span",{className:"text-xs",style:{fontSize:"0.2em"},children:["Owners: ",u.length]})]})]})]})]})}function Gt(...e){return e.filter(Boolean).join(" ")}function Kc({data:e,sourcePosition:t,targetPosition:n}){const{mode:o,message:s,showSource:r=!0,showTarget:i=!0}=e,{name:c,version:a,summary:d,owners:u=[],producers:f=[],consumers:h=[]}=s.data,m=i||n&&f.length>0,S=r||t&&h.length>0;return I.jsxs("div",{className:Gt("w-full rounded-md border flex justify-start  bg-white text-black border-blue-400"),children:[I.jsxs("div",{className:Gt("bg-gradient-to-b from-blue-500 to-blue-700 relative flex items-center w-5 justify-center rounded-l-sm text-blue-100-500","border-r-[1px] border-blue-500"),children:[I.jsx(ls,{className:"w-4 h-4 opacity-90 text-white absolute top-1 "}),o==="full"&&I.jsx("span",{className:"rotate -rotate-90 w-1/2 text-center absolute bottom-1 text-[9px] text-white font-bold uppercase tracking-[3px] ",children:"Command"})]}),I.jsxs("div",{className:"p-1 min-w-60 max-w-[min-content]",children:[m&&I.jsx(be,{type:"target",position:n}),S&&I.jsx(be,{type:"source",position:t}),I.jsxs("div",{className:Gt(o==="full"?"border-b border-gray-200":""),children:[I.jsx("span",{className:"text-xs font-bold block pb-0.5",children:c}),I.jsxs("div",{className:"flex justify-between",children:[I.jsxs("span",{className:"text-[10px] font-light block pt-0.5 pb-0.5 ",children:["v",a]}),o==="simple"&&I.jsx("span",{className:"text-[10px] text-gray-500 font-light block pt-0.5 pb-0.5 ",children:"Command"})]})]}),o==="full"&&I.jsxs("div",{className:"divide-y divide-gray-200 ",children:[I.jsx("div",{className:"leading-3 py-1",children:I.jsx("span",{className:"text-[8px] font-light",children:d})}),I.jsxs("div",{className:"grid grid-cols-2 gap-x-4 py-1",children:[I.jsxs("span",{className:"text-xs",style:{fontSize:"0.2em"},children:["Producers: ",f.length]}),I.jsxs("span",{className:"text-xs",style:{fontSize:"0.2em"},children:["Consumers: ",h.length]}),I.jsxs("span",{className:"text-xs",style:{fontSize:"0.2em"},children:["Owners: ",u.length]})]})]})]})]})}function qc(e,t){if(e.match(/^[a-z]+:\/\//i))return e;if(e.match(/^\/\//))return window.location.protocol+e;if(e.match(/^[a-z]+:/i))return e;const n=document.implementation.createHTMLDocument(),o=n.createElement("base"),s=n.createElement("a");return n.head.appendChild(o),n.body.appendChild(s),t&&(o.href=t),s.href=e,s.href}const Qc=(()=>{let e=0;const t=()=>`0000${(Math.random()*36**4<<0).toString(36)}`.slice(-4);return()=>(e+=1,`u${t()}${e}`)})();function Ne(e){const t=[];for(let n=0,o=e.length;n<o;n++)t.push(e[n]);return t}function Ct(e,t){const o=(e.ownerDocument.defaultView||window).getComputedStyle(e).getPropertyValue(t);return o?parseFloat(o.replace("px","")):0}function Jc(e){const t=Ct(e,"border-left-width"),n=Ct(e,"border-right-width");return e.clientWidth+t+n}function ea(e){const t=Ct(e,"border-top-width"),n=Ct(e,"border-bottom-width");return e.clientHeight+t+n}function us(e,t={}){const n=t.width||Jc(e),o=t.height||ea(e);return{width:n,height:o}}function ta(){let e,t;try{t=process}catch{}const n=t&&t.env?t.env.devicePixelRatio:null;return n&&(e=parseInt(n,10),Number.isNaN(e)&&(e=1)),e||window.devicePixelRatio||1}const le=16384;function na(e){(e.width>le||e.height>le)&&(e.width>le&&e.height>le?e.width>e.height?(e.height*=le/e.width,e.width=le):(e.width*=le/e.height,e.height=le):e.width>le?(e.height*=le/e.width,e.width=le):(e.width*=le/e.height,e.height=le))}function Mt(e){return new Promise((t,n)=>{const o=new Image;o.decode=()=>t(o),o.onload=()=>t(o),o.onerror=n,o.crossOrigin="anonymous",o.decoding="async",o.src=e})}async function oa(e){return Promise.resolve().then(()=>new XMLSerializer().serializeToString(e)).then(encodeURIComponent).then(t=>`data:image/svg+xml;charset=utf-8,${t}`)}async function sa(e,t,n){const o="http://www.w3.org/2000/svg",s=document.createElementNS(o,"svg"),r=document.createElementNS(o,"foreignObject");return s.setAttribute("width",`${t}`),s.setAttribute("height",`${n}`),s.setAttribute("viewBox",`0 0 ${t} ${n}`),r.setAttribute("width","100%"),r.setAttribute("height","100%"),r.setAttribute("x","0"),r.setAttribute("y","0"),r.setAttribute("externalResourcesRequired","true"),s.appendChild(r),r.appendChild(e),oa(s)}const ie=(e,t)=>{if(e instanceof t)return!0;const n=Object.getPrototypeOf(e);return n===null?!1:n.constructor.name===t.name||ie(n,t)};function ra(e){const t=e.getPropertyValue("content");return`${e.cssText} content: '${t.replace(/'|"/g,"")}';`}function ia(e){return Ne(e).map(t=>{const n=e.getPropertyValue(t),o=e.getPropertyPriority(t);return`${t}: ${n}${o?" !important":""};`}).join(" ")}function ca(e,t,n){const o=`.${e}:${t}`,s=n.cssText?ra(n):ia(n);return document.createTextNode(`${o}{${s}}`)}function Jn(e,t,n){const o=window.getComputedStyle(e,n),s=o.getPropertyValue("content");if(s===""||s==="none")return;const r=Qc();try{t.className=`${t.className} ${r}`}catch{return}const i=document.createElement("style");i.appendChild(ca(r,n,o)),t.appendChild(i)}function aa(e,t){Jn(e,t,":before"),Jn(e,t,":after")}const eo="application/font-woff",to="image/jpeg",la={woff:eo,woff2:eo,ttf:"application/font-truetype",eot:"application/vnd.ms-fontobject",png:"image/png",jpg:to,jpeg:to,gif:"image/gif",tiff:"image/tiff",svg:"image/svg+xml",webp:"image/webp"};function ua(e){const t=/\.([^./]*?)$/g.exec(e);return t?t[1]:""}function wn(e){const t=ua(e).toLowerCase();return la[t]||""}function da(e){return e.split(/,/)[1]}function cn(e){return e.search(/^(data:)/)!==-1}function fa(e,t){return`data:${t};base64,${e}`}async function ds(e,t,n){const o=await fetch(e,t);if(o.status===404)throw new Error(`Resource "${o.url}" not found`);const s=await o.blob();return new Promise((r,i)=>{const c=new FileReader;c.onerror=i,c.onloadend=()=>{try{r(n({res:o,result:c.result}))}catch(a){i(a)}},c.readAsDataURL(s)})}const Kt={};function ha(e,t,n){let o=e.replace(/\?.*/,"");return n&&(o=e),/ttf|otf|eot|woff2?/i.test(o)&&(o=o.replace(/.*\//,"")),t?`[${t}]${o}`:o}async function En(e,t,n){const o=ha(e,t,n.includeQueryParams);if(Kt[o]!=null)return Kt[o];n.cacheBust&&(e+=(/\?/.test(e)?"&":"?")+new Date().getTime());let s;try{const r=await ds(e,n.fetchRequestInit,({res:i,result:c})=>(t||(t=i.headers.get("Content-Type")||""),da(c)));s=fa(r,t)}catch(r){s=n.imagePlaceholder||"";let i=`Failed to fetch resource: ${e}`;r&&(i=typeof r=="string"?r:r.message),i&&console.warn(i)}return Kt[o]=s,s}async function ga(e){const t=e.toDataURL();return t==="data:,"?e.cloneNode(!1):Mt(t)}async function ma(e,t){if(e.currentSrc){const r=document.createElement("canvas"),i=r.getContext("2d");r.width=e.clientWidth,r.height=e.clientHeight,i?.drawImage(e,0,0,r.width,r.height);const c=r.toDataURL();return Mt(c)}const n=e.poster,o=wn(n),s=await En(n,o,t);return Mt(s)}async function pa(e){var t;try{if(!((t=e?.contentDocument)===null||t===void 0)&&t.body)return await At(e.contentDocument.body,{},!0)}catch{}return e.cloneNode(!1)}async function ya(e,t){return ie(e,HTMLCanvasElement)?ga(e):ie(e,HTMLVideoElement)?ma(e,t):ie(e,HTMLIFrameElement)?pa(e):e.cloneNode(!1)}const xa=e=>e.tagName!=null&&e.tagName.toUpperCase()==="SLOT";async function wa(e,t,n){var o,s;let r=[];return xa(e)&&e.assignedNodes?r=Ne(e.assignedNodes()):ie(e,HTMLIFrameElement)&&(!((o=e.contentDocument)===null||o===void 0)&&o.body)?r=Ne(e.contentDocument.body.childNodes):r=Ne(((s=e.shadowRoot)!==null&&s!==void 0?s:e).childNodes),r.length===0||ie(e,HTMLVideoElement)||await r.reduce((i,c)=>i.then(()=>At(c,n)).then(a=>{a&&t.appendChild(a)}),Promise.resolve()),t}function Ea(e,t){const n=t.style;if(!n)return;const o=window.getComputedStyle(e);o.cssText?(n.cssText=o.cssText,n.transformOrigin=o.transformOrigin):Ne(o).forEach(s=>{let r=o.getPropertyValue(s);s==="font-size"&&r.endsWith("px")&&(r=`${Math.floor(parseFloat(r.substring(0,r.length-2)))-.1}px`),ie(e,HTMLIFrameElement)&&s==="display"&&r==="inline"&&(r="block"),s==="d"&&t.getAttribute("d")&&(r=`path(${t.getAttribute("d")})`),n.setProperty(s,r,o.getPropertyPriority(s))})}function ba(e,t){ie(e,HTMLTextAreaElement)&&(t.innerHTML=e.value),ie(e,HTMLInputElement)&&t.setAttribute("value",e.value)}function Sa(e,t){if(ie(e,HTMLSelectElement)){const n=t,o=Array.from(n.children).find(s=>e.value===s.getAttribute("value"));o&&o.setAttribute("selected","")}}function va(e,t){return ie(t,Element)&&(Ea(e,t),aa(e,t),ba(e,t),Sa(e,t)),t}async function Na(e,t){const n=e.querySelectorAll?e.querySelectorAll("use"):[];if(n.length===0)return e;const o={};for(let r=0;r<n.length;r++){const c=n[r].getAttribute("xlink:href");if(c){const a=e.querySelector(c),d=document.querySelector(c);!a&&d&&!o[c]&&(o[c]=await At(d,t,!0))}}const s=Object.values(o);if(s.length){const r="http://www.w3.org/1999/xhtml",i=document.createElementNS(r,"svg");i.setAttribute("xmlns",r),i.style.position="absolute",i.style.width="0",i.style.height="0",i.style.overflow="hidden",i.style.display="none";const c=document.createElementNS(r,"defs");i.appendChild(c);for(let a=0;a<s.length;a++)c.appendChild(s[a]);e.appendChild(i)}return e}async function At(e,t,n){return!n&&t.filter&&!t.filter(e)?null:Promise.resolve(e).then(o=>ya(o,t)).then(o=>wa(e,o,t)).then(o=>va(e,o)).then(o=>Na(o,t))}const fs=/url\((['"]?)([^'"]+?)\1\)/g,Ca=/url\([^)]+\)\s*format\((["']?)([^"']+)\1\)/g,Ma=/src:\s*(?:url\([^)]+\)\s*format\([^)]+\)[,;]\s*)+/g;function $a(e){const t=e.replace(/([.*+?^${}()|\[\]\/\\])/g,"\\$1");return new RegExp(`(url\\(['"]?)(${t})(['"]?\\))`,"g")}function ka(e){const t=[];return e.replace(fs,(n,o,s)=>(t.push(s),n)),t.filter(n=>!cn(n))}async function Ra(e,t,n,o,s){try{const r=n?qc(t,n):t,i=wn(t);let c;return s||(c=await En(r,i,o)),e.replace($a(t),`$1${c}$3`)}catch{}return e}function Ta(e,{preferredFontFormat:t}){return t?e.replace(Ma,n=>{for(;;){const[o,,s]=Ca.exec(n)||[];if(!s)return"";if(s===t)return`src: ${o};`}}):e}function hs(e){return e.search(fs)!==-1}async function gs(e,t,n){if(!hs(e))return e;const o=Ta(e,n);return ka(o).reduce((r,i)=>r.then(c=>Ra(c,i,t,n)),Promise.resolve(o))}async function bt(e,t,n){var o;const s=(o=t.style)===null||o===void 0?void 0:o.getPropertyValue(e);if(s){const r=await gs(s,null,n);return t.style.setProperty(e,r,t.style.getPropertyPriority(e)),!0}return!1}async function za(e,t){await bt("background",e,t)||await bt("background-image",e,t),await bt("mask",e,t)||await bt("mask-image",e,t)}async function Aa(e,t){const n=ie(e,HTMLImageElement);if(!(n&&!cn(e.src))&&!(ie(e,SVGImageElement)&&!cn(e.href.baseVal)))return;const o=n?e.src:e.href.baseVal,s=await En(o,wn(o),t);await new Promise((r,i)=>{e.onload=r,e.onerror=i;const c=e;c.decode&&(c.decode=r),c.loading==="lazy"&&(c.loading="eager"),n?(e.srcset="",e.src=s):e.href.baseVal=s})}async function _a(e,t){const o=Ne(e.childNodes).map(s=>ms(s,t));await Promise.all(o).then(()=>e)}async function ms(e,t){ie(e,Element)&&(await za(e,t),await Aa(e,t),await _a(e,t))}function Ia(e,t){const{style:n}=e;t.backgroundColor&&(n.backgroundColor=t.backgroundColor),t.width&&(n.width=`${t.width}px`),t.height&&(n.height=`${t.height}px`);const o=t.style;return o!=null&&Object.keys(o).forEach(s=>{n[s]=o[s]}),e}const no={};async function oo(e){let t=no[e];if(t!=null)return t;const o=await(await fetch(e)).text();return t={url:e,cssText:o},no[e]=t,t}async function so(e,t){let n=e.cssText;const o=/url\(["']?([^"')]+)["']?\)/g,r=(n.match(/url\([^)]+\)/g)||[]).map(async i=>{let c=i.replace(o,"$1");return c.startsWith("https://")||(c=new URL(c,e.url).href),ds(c,t.fetchRequestInit,({result:a})=>(n=n.replace(i,`url(${a})`),[i,a]))});return Promise.all(r).then(()=>n)}function ro(e){if(e==null)return[];const t=[],n=/(\/\*[\s\S]*?\*\/)/gi;let o=e.replace(n,"");const s=new RegExp("((@.*?keyframes [\\s\\S]*?){([\\s\\S]*?}\\s*?)})","gi");for(;;){const a=s.exec(o);if(a===null)break;t.push(a[0])}o=o.replace(s,"");const r=/@import[\s\S]*?url\([^)]*\)[\s\S]*?;/gi,i="((\\s*?(?:\\/\\*[\\s\\S]*?\\*\\/)?\\s*?@media[\\s\\S]*?){([\\s\\S]*?)}\\s*?})|(([\\s\\S]*?){([\\s\\S]*?)})",c=new RegExp(i,"gi");for(;;){let a=r.exec(o);if(a===null){if(a=c.exec(o),a===null)break;r.lastIndex=c.lastIndex}else c.lastIndex=r.lastIndex;t.push(a[0])}return t}async function Da(e,t){const n=[],o=[];return e.forEach(s=>{if("cssRules"in s)try{Ne(s.cssRules||[]).forEach((r,i)=>{if(r.type===CSSRule.IMPORT_RULE){let c=i+1;const a=r.href,d=oo(a).then(u=>so(u,t)).then(u=>ro(u).forEach(f=>{try{s.insertRule(f,f.startsWith("@import")?c+=1:s.cssRules.length)}catch(h){console.error("Error inserting rule from remote css",{rule:f,error:h})}})).catch(u=>{console.error("Error loading remote css",u.toString())});o.push(d)}})}catch(r){const i=e.find(c=>c.href==null)||document.styleSheets[0];s.href!=null&&o.push(oo(s.href).then(c=>so(c,t)).then(c=>ro(c).forEach(a=>{i.insertRule(a,s.cssRules.length)})).catch(c=>{console.error("Error loading remote stylesheet",c)})),console.error("Error inlining remote css file",r)}}),Promise.all(o).then(()=>(e.forEach(s=>{if("cssRules"in s)try{Ne(s.cssRules||[]).forEach(r=>{n.push(r)})}catch(r){console.error(`Error while reading CSS rules from ${s.href}`,r)}}),n))}function Pa(e){return e.filter(t=>t.type===CSSRule.FONT_FACE_RULE).filter(t=>hs(t.style.getPropertyValue("src")))}async function Ha(e,t){if(e.ownerDocument==null)throw new Error("Provided element is not within a Document");const n=Ne(e.ownerDocument.styleSheets),o=await Da(n,t);return Pa(o)}async function Oa(e,t){const n=await Ha(e,t);return(await Promise.all(n.map(s=>{const r=s.parentStyleSheet?s.parentStyleSheet.href:null;return gs(s.cssText,r,t)}))).join(`
`)}async function Va(e,t){const n=t.fontEmbedCSS!=null?t.fontEmbedCSS:t.skipFonts?null:await Oa(e,t);if(n){const o=document.createElement("style"),s=document.createTextNode(n);o.appendChild(s),e.firstChild?e.insertBefore(o,e.firstChild):e.appendChild(o)}}async function La(e,t={}){const{width:n,height:o}=us(e,t),s=await At(e,t,!0);return await Va(s,t),await ms(s,t),Ia(s,t),await sa(s,n,o)}async function ja(e,t={}){const{width:n,height:o}=us(e,t),s=await La(e,t),r=await Mt(s),i=document.createElement("canvas"),c=i.getContext("2d"),a=t.pixelRatio||ta(),d=t.canvasWidth||n,u=t.canvasHeight||o;return i.width=d*a,i.height=u*a,t.skipAutoScale||na(i),i.style.width=`${d}`,i.style.height=`${u}`,t.backgroundColor&&(c.fillStyle=t.backgroundColor,c.fillRect(0,0,i.width,i.height)),c.drawImage(r,0,0,i.width,i.height),i}async function Fa(e,t={}){return(await ja(e,t)).toDataURL()}function Ba({title:e,titleId:t,...n},o){return w.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":t},n),e?w.createElement("title",{id:t},e):null,w.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m.75 12 3 3m0 0 3-3m-3 3v-6m-1.5-9H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const Ua=w.forwardRef(Ba);function Za(e,t){const n=document.createElement("a");n.setAttribute("download",`${t||"eventcatalog"}.png`),n.setAttribute("href",e),n.click()}const io=1024,co=768;function Wa({filename:e,addPadding:t=!0}){const{getNodes:n}=zt(),o=()=>{ii(n()),document.getElementById("download-visual").style.display="none",document.querySelector(".react-flow__controls").style.display="none",Fa(document.querySelector(".react-flow"),{backgroundColor:"#f1f1f1",width:io*1.2,height:co,style:{width:io*1.2,height:co}}).then(s=>{Za(s,e),document.getElementById("download-visual").style.display="block",document.querySelector(".react-flow__controls").style.display="block"})};return I.jsx(dt,{position:"top-right",id:"download-visual",children:I.jsxs("button",{className:`hidden md:flex bg-white group download-btn items-center space-x-1 text-[14px] border border-gray-200 px-1 py-0.5 rounded-md hover:bg-gray-100/50 ${t?"mt-14":"-mt-1"}`,onClick:o,children:[I.jsx(Ua,{className:"w-4 h-4 group-hover:text-purple-500"}),I.jsx("span",{className:"group-hover:text-purple-500",children:"Download visual "})]})})}const ao=e=>fo(`/docs/${e.collection}/${e.data.id}/${e.data.version}`),lo=e=>fo(`/visualiser/${e.collection}/${e.data.id}/${e.data.version}`),Ya=({nodes:e,edges:t,title:n,includeBackground:o=!0,linkTo:s="docs"})=>{const r=w.useMemo(()=>({services:Xc,events:Gc,commands:Kc}),[]),i=[.5,.5],c=(a,d)=>{(d.type==="events"||d.type==="commands")&&Cn(s==="docs"?ao(d.data.message):lo(d.data.message)),d.type==="services"&&Cn(s==="docs"?ao(d.data.service):lo(d.data.service))};return I.jsxs(is,{nodeTypes:r,nodes:e,edges:t,fitView:!0,nodesDraggable:!0,connectionLineType:ve.SmoothStep,nodeOrigin:i,onNodeClick:c,children:[n&&I.jsx(dt,{position:"top-right",children:I.jsxs("span",{className:"block shadow-sm bg-white text-xl z-10 text-black px-4 py-2 border-gray-200 rounded-md border",children:[I.jsx("strong",{children:"Visualiser"})," | ",n]})}),I.jsx(Wa,{filename:n,addPadding:!!n}),o&&I.jsx(Uc,{color:"#bbb",gap:16}),o&&I.jsx(Hc,{}),I.jsx(dt,{position:"bottom-right",children:I.jsxs("div",{className:" bg-white font-light px-4 text-[14px] shadow-md py-1 rounded-md",children:[I.jsx("span",{className:"font-bold",children:"Key"}),I.jsxs("ul",{children:[I.jsxs("li",{className:"flex space-x-2 items-center text-[12px]",children:[I.jsx("span",{className:"w-2 h-2 bg-orange-500 block"}),I.jsx("span",{className:"block",children:"Event"})]}),I.jsxs("li",{className:"flex space-x-2 items-center text-[12px]",children:[I.jsx("span",{className:"w-2 h-2 bg-pink-500 block"}),I.jsx("span",{className:"block",children:"Service"})]}),I.jsxs("li",{className:"flex space-x-2 items-center text-[12px]",children:[I.jsx("span",{className:"w-2 h-2 bg-blue-500 block"}),I.jsx("span",{className:"block",children:"Command"})]})]})]})})]})},nl=({id:e,nodes:t,edges:n,title:o,href:s,linkTo:r="docs",hrefLabel:i="Open in visualiser"})=>{const[c,a]=w.useState(null);return w.useEffect(()=>{a(document.getElementById(`${e}-portal`))},[]),c?I.jsx("div",{children:Gs.createPortal(I.jsxs(xn,{children:[I.jsx(Ya,{edges:n,nodes:t,title:o,linkTo:r}),s&&I.jsx("div",{className:"py-2 w-full text-right",children:I.jsxs("a",{className:" text-sm no-underline py-2 text-gray-800 hover:text-purple-500",href:s,children:[i," →"]})})]}),c)}):null};export{nl as default};
